@istest
public class CG_Escalate_Test {
    
    static testmethod void testMethod1()
    {
        CSS_Job_Order__c JO1;
        JO1 = CSS_TestData.createJobOrder(true);
        
        RecordType recType = [SELECT Id, Name FROM RecordType WHERE NAME='TSREscalation'];
        
        css_jobforms__c JF1 = new css_jobforms__c();
        JF1.TSR_SRNumber__c = '12345';
        JF1.Service_Job__c = JO1.id;
        
        system.debug(recType);
        
        JF1.RecordTypeId = recType.id;
        insert JF1;
            system.debug(JF1);
        
        
        CSS_JobForm_Detail__c JFD =  new CSS_JobForm_Detail__c();
        
            JFD.TSR_Request__c = '{"Header":{"Target":{"TargetID":"TSR"},"Sender":{"ServiceName":"UpsertTSR","SenderID":"GUIDANZ"}},"DataArea":{"UOM":"miles","TechID":null,"Symptom":null,"SupportLevel":"Cummins CARE Level 2","Status":"Open","SRNumber":"","SPCode":"21933","ShopWO":"","RepeatVisit":"Y","PSN":"79462880","MileageValue":"0","GeneralSymptoms":"","FaultCodeStatus":null,"FaultCode":null,"FailureDate":"11/3/2017","EscalationText":"","EscalationGroup":"HMLD","CustomerName":"test","CSSJobID":"CSS-00070816","ContactPhoneNumber":"","ContactLastName":"Anirudh","ContactFirstName":"Pesari","ContactEmail":"pesari.anirudh@cummins.com","ComplaintCode":"102","AttachmentURL":""}}';
            JFD.TSR_Response__c = '{"DataArea":{"ActivityDescription":"","ErrorMessage":"Success","ActivityOwner":"Brent A Engel","ActivityID":"1-HIK94EX","TSRNumber":"1-38127705523","ActivityType":"Escalation","ActivitySubject":"","ErrorCode":"","CSSJobID":"CSS-00070816"},"Header":{"ReturnCodeDescription":"Success","Status":"SUCCESS","ReturnCode":"","MessageIdentifier":"CSS-00070816"}}';
            JFD.TSR_ActivityType__c = 'Escalation';
            JFD.TSR_ActivityID__c = '1-HIK8XJP';
            JFD.TSR_ActivityOwner__c = 'Brent A Engel';
            JFD.TSR_ActivitySubject__c ='';
            JFD.TSR_ActivityDescription__c ='';
            JFD.CSS_JobForms__c = JF1.id;
        insert JFD;
        datetime currentDate = System.now();
        //string currDate = currentDate.format('YYYY-MM-dd') +'T00:00:00';
        //JFD.LastModifiedDate = currentDate;
        //update JFD;
    CSS_JobEventTemporary__c  jeventTemp = new CSS_JobEventTemporary__c(attribute1__c='CategoryComplaintCodes',Reason__c='{"DataArea":{"Details":[{"Category":"Fuel - Oil - Coolant","Description":"COOLANT LOSS - OVERFLOW","BusinessUnit":"EBU","ComplaintCode":"106","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"FUEL CONSUMPTION EXCESSIVE","BusinessUnit":"EBU","ComplaintCode":"117","ActiveFlag":"Y"},{"Category":"Leak","Description":"EXHAUST LEAK","BusinessUnit":"EBU","ComplaintCode":"118","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"ENGINE SHUTS DOWN OR STALLS","BusinessUnit":"EBU","ComplaintCode":"205","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"ENGINE SURGES","BusinessUnit":"EBU","ComplaintCode":"212","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"LOW POWER","BusinessUnit":"EBU","ComplaintCode":"213","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"VIBRATION","BusinessUnit":"EBU","ComplaintCode":"401","ActiveFlag":"Y"},{"Category":"Component/Part Specific Issue","Description":"INOPERATIVE COMPONENT","BusinessUnit":"EBU","ComplaintCode":"404","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"ENGINE RUNS ROUGH","BusinessUnit":"EBU","ComplaintCode":"215","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"FUEL LEAK INTERNAL - IN OIL","BusinessUnit":"EBU","ComplaintCode":"115","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"FUEL LEAK INTERNAL - IN COOLANT","BusinessUnit":"EBU","ComplaintCode":"116","ActiveFlag":"Y"},{"Category":"Leak","Description":"COMPRESSION LEAK","BusinessUnit":"EBU","ComplaintCode":"120","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"CHECK ENGINE LIGHT - RED","BusinessUnit":"EBU","ComplaintCode":"202","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"ENGINE WILL NOT SHUT DOWN","BusinessUnit":"EBU","ComplaintCode":"211","ActiveFlag":"Y"},{"Category":"Component/Part Specific Issue","Description":"CRUISE CONTROL","BusinessUnit":"EBU","ComplaintCode":"503","ActiveFlag":"Y"},{"Category":"Other","Description":"INSPECTION","BusinessUnit":"EBU","ComplaintCode":"603","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"OIL IN AIR SYSTEM","BusinessUnit":"EBU","ComplaintCode":"121","ActiveFlag":"Y"},{"Category":"Component/Part Specific Issue","Description":"TURBO NOISE","BusinessUnit":"EBU","ComplaintCode":"123","ActiveFlag":"Y"},{"Category":"Component/Part Specific Issue","Description":"TURBO BLOWING OIL OUT EXHAUST","BusinessUnit":"EBU","ComplaintCode":"124","ActiveFlag":"Y"},{"Category":"Component/Part Specific Issue","Description":"TURBO BLOWING OIL IN INTAKE","BusinessUnit":"EBU","ComplaintCode":"125","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"CHECK ENGINE LIGHT - YELLOW","BusinessUnit":"EBU","ComplaintCode":"201","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"WILL NOT REACH RPM","BusinessUnit":"EBU","ComplaintCode":"206","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"IDLE SPEED HIGH","BusinessUnit":"EBU","ComplaintCode":"208","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"POOR THROTTLE RESPONSE","BusinessUnit":"EBU","ComplaintCode":"214","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"HIGH BLOW-BY","BusinessUnit":"EBU","ComplaintCode":"408","ActiveFlag":"Y"},{"Category":"Other","Description":"REBUILD","BusinessUnit":"EBU","ComplaintCode":"602","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"REGEN WILL NOT COMPLETE","BusinessUnit":"EBU","ComplaintCode":"606","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"COOLANT LEAK EXTERNAL","BusinessUnit":"EBU","ComplaintCode":"101","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"WILL NOT BUILD AIR OR BUILDS SLOWLY","BusinessUnit":"EBU","ComplaintCode":"122","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"ROUGH IDLE","BusinessUnit":"EBU","ComplaintCode":"209","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"BLACK SMOKE","BusinessUnit":"EBU","ComplaintCode":"302","ActiveFlag":"Y"},{"Category":"Other","Description":"VOLTAGE (GENSET)","BusinessUnit":"EBU","ComplaintCode":"505","ActiveFlag":"Y"},{"Category":"Component/Part Specific Issue","Description":"STARTER MOTOR MALFUNCTIONING","BusinessUnit":"EBU","ComplaintCode":"508","ActiveFlag":"Y"},{"Category":"Other","Description":"CAMPAIGN / TRP","BusinessUnit":"EBU","ComplaintCode":"601","ActiveFlag":"Y"},{"Category":"Other","Description":"FAILED EMISSION TEST","BusinessUnit":"EBU","ComplaintCode":"604","ActiveFlag":"Y"},{"Category":"Other","Description":"MAINTENANCE","BusinessUnit":"EBU","ComplaintCode":"605","ActiveFlag":"Y"},{"Category":"Other","Description":"TELEMATICS","BusinessUnit":"EBU","ComplaintCode":"990","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"HARD START","BusinessUnit":"EBU","ComplaintCode":"203","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"WILL NOT START","BusinessUnit":"EBU","ComplaintCode":"204","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"ENGINE MISFIRE","BusinessUnit":"EBU","ComplaintCode":"210","ActiveFlag":"Y"},{"Category":"Component/Part Specific Issue","Description":"ENGINE BRAKE MALFUNCTIONING","BusinessUnit":"EBU","ComplaintCode":"406","ActiveFlag":"Y"},{"Category":"Component/Part Specific Issue","Description":"BLOWING DIPSTCK OUT","BusinessUnit":"EBU","ComplaintCode":"407","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"COOLANT LEAK INTERNAL - NOT IN OIL","BusinessUnit":"EBU","ComplaintCode":"102","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"OIL LEAK EXTERNAL","BusinessUnit":"EBU","ComplaintCode":"107","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"OIL TEMPERATURE LOW","BusinessUnit":"EBU","ComplaintCode":"109","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"OIL PRESSURE HIGH","BusinessUnit":"EBU","ComplaintCode":"112","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"OIL CONSUMPTION EXCESSIVE","BusinessUnit":"EBU","ComplaintCode":"113","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"IDLE SPEED LOW","BusinessUnit":"EBU","ComplaintCode":"207","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"WHITE SMOKE","BusinessUnit":"EBU","ComplaintCode":"301","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"NOISE IN ENGINE","BusinessUnit":"EBU","ComplaintCode":"402","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"WILL NOT CARRY LOAD (GENSET)","BusinessUnit":"EBU","ComplaintCode":"504","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"REGEN TOO FREQUENT","BusinessUnit":"EBU","ComplaintCode":"608","ActiveFlag":"Y"},{"Category":"Leak","Description":"DEF LEAK","BusinessUnit":"EBU","ComplaintCode":"609","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"COOLANT LEAK INTERNAL - IN OIL","BusinessUnit":"EBU","ComplaintCode":"103","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"OIL IN COOLANT","BusinessUnit":"EBU","ComplaintCode":"108","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"FUEL LEAK EXTERNAL","BusinessUnit":"EBU","ComplaintCode":"114","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"BLUE SMOKE","BusinessUnit":"EBU","ComplaintCode":"303","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"ENGINE OVERSPEED","BusinessUnit":"EBU","ComplaintCode":"409","ActiveFlag":"Y"},{"Category":"Component/Part Specific Issue","Description":"BELT PROBLEM","BusinessUnit":"EBU","ComplaintCode":"410","ActiveFlag":"Y"},{"Category":"Component/Part Specific Issue","Description":"ALTERNATOR MALFUNCTIONING","BusinessUnit":"EBU","ComplaintCode":"507","ActiveFlag":"Y"},{"Category":"Other","Description":"OTHER - SEE TEXT FOR DESCRIPTION","BusinessUnit":"EBU","ComplaintCode":"999","ActiveFlag":"Y"},{"Category":"Symptom / Performance","Description":"REGEN WILL NOT START","BusinessUnit":"EBU","ComplaintCode":"607","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"COOLANT TEMPERATURE LOW","BusinessUnit":"EBU","ComplaintCode":"104","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"COOLANT TEMPERATURE HIGH","BusinessUnit":"EBU","ComplaintCode":"105","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"OIL TEMPERATURE HIGH","BusinessUnit":"EBU","ComplaintCode":"110","ActiveFlag":"Y"},{"Category":"Fuel - Oil - Coolant","Description":"OIL PRESSURE LOW","BusinessUnit":"EBU","ComplaintCode":"111","ActiveFlag":"Y"},{"Category":"Leak","Description":"AIR LEAK","BusinessUnit":"EBU","ComplaintCode":"119","ActiveFlag":"Y"},{"Category":"Component/Part Specific Issue","Description":"NOISY COMPONENT","BusinessUnit":"EBU","ComplaintCode":"403","ActiveFlag":"Y"},{"Category":"Component/Part Specific Issue","Description":"LOOSE OR BROKEN MOUNTING HARDWARE","BusinessUnit":"EBU","ComplaintCode":"405","ActiveFlag":"Y"},{"Category":"Component/Part Specific Issue","Description":"BREAKER TRIPPING","BusinessUnit":"EBU","ComplaintCode":"506","ActiveFlag":"Y"}]},"Header":{"ReturnCodeDescription":"","Status":"Success"}}');
 insert jeventTemp;
        apexpages.currentPage().getParameters().put('id',JO1.id);
        test.startTest();
        CG_Escalate escButton = new CG_Escalate();
        escButton.JobId = JO1.id;
        escButton.TSRNumber = '123456';
        escButton.EscalationView();
        String complainType;
       complainType = CG_Escalate.deriveComplaintType('OIL PRESSURE LOW');
        test.stopTest();
    }

}