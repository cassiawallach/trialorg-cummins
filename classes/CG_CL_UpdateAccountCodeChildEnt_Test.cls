@isTest
public class CG_CL_UpdateAccountCodeChildEnt_Test {
    static testmethod void testmethod1(){
        CG_CL_UpdateAccountCodeChildEntities upd = new CG_CL_UpdateAccountCodeChildEntities();
        Account acc = new Account();
        acc.name='Kenworth Sales Co';
        acc.CSS_DistributorCode__c='02650';
        acc.IAM_Service_Provider_Code__c='97895';
        acc.type='Dealer Account';
        insert acc;
        CSS_Claims__c testclaimsRec = new CSS_Claims__c();
        
        testclaimsRec.Customer_Name__c='Test Customer';
        testclaimsRec.Customer_Code__c = '1234';
        testclaimsRec.Contact_Last_Name__c = 'T';
        testclaimsRec.Address__c = 'T';
        testclaimsRec.Customer_Contact_Phone__c = null;
        testclaimsRec.Email_Address__c = 'rp@sct.com';
        testclaimsRec.Status__c = 'Draft';
        testclaimsRec.TSR1__c = '1234';
        testclaimsRec.TSR2__c = '1234';
        testclaimsRec.TSR3__c = '1234';
        testclaimsRec.TSR4__c = '1234';
        testclaimsRec.TSR5__c = '1234';
        testclaimsRec.TSR6__c = '1234';
        testclaimsRec.TSR7__c = '1234';
        testclaimsRec.TSR8__c = '1234';
        testclaimsRec.TSR9__c = '1234';
        testclaimsRec.TSR10__c = '1234';
        testclaimsRec.Country__c = '1234';
        testclaimsRec.State__c = '1234';
        testclaimsRec.ZipCode__c = '12345-1234';
        testclaimsRec.PartReturnToCenter__c = 'Test';
        testclaimsRec.Account__c=acc.Id;
        //testclaimsRec.SP_INSHOP_LABOR_RATE__c='test';
        insert testclaimsRec;
        CSS_PSN__c psn = new CSS_PSN__c();
        psn.CSS_Claims__c = testclaimsRec.id;
        psn.Primary__c = true;
        insert psn;
        
        String stestclaimid = String.valueOf(testclaimsRec.Id);
        
        
        list<CSS_Solution_Component__c> lstsol = new list<CSS_Solution_Component__c>();
        CSS_Solution_Component__c solcomp = new CSS_Solution_Component__c();
        solcomp.Name='test';
        solcomp.Selected_Component__c=true;
        solcomp.AccountCode__c='65';
        solcomp.CSS_Claims__c=testclaimsRec.id;
        solcomp.Service_Job__c=null;
        //solcomp.Status__c='Approved';
        solcomp.CoveredLaborHrs__c='4';
        solcomp.AccountCodeType__c ='CMP – Field Actions';
        solcomp.CampaignLaborPercentage__c='2';
        solcomp.Fail_Code_Editable__c ='TRP 2035-WUSSCB';
        solcomp.Type__c='test';
        
        lstsol.add(solcomp);
        insert lstsol;
        String solcompid = String.valueOf(solcomp.Id);
        List<CSS_Solution_Component__c> cs =[select id,Service_Job__c,CampaignLaborPercentage__c , CSS_Account_Formula__c,FailCode_Formula__c from CSS_Solution_Component__c where id =:solcomp.id];
        system.debug('lstsol '+cs);
        CSS_Parts_Options__c prtsopnrec = new CSS_Parts_Options__c();
        prtsopnrec.Account_Code__c = 'CMP – Field Actions 65';
        prtsopnrec.CSS_Claims__c = testclaimsrec.id;
        // prtsopnrec.ReturnWaiver__c = false;
        // prtsopnrec.ReturnToFactory__c = 'Test';
        prtsopnrec.City__c = 'Bangalore';
        prtsopnrec.Claimtype__c = 'Test';
        prtsopnrec.Comments__c = 'Test';
        prtsopnrec.Create_Date__c = '18092018';
        prtsopnrec.Fail_Code__c = 'TEST';
        prtsopnrec.Parts_Return__c = 'Test';
        prtsopnrec.ReturnToFactory__c = 'Y';
        prtsopnrec.ReturnWaiver__c = false;
        prtsopnrec.selected_part__c=true;
        //prtsopnrec.FailurepartId__c=solcomp1.id;
        insert prtsopnrec;
        CSS_Parts_Options__c cp =[select id, FailurepartId__r.Service_Job__c, selected_part__c, ReturnWaiver__c, ReturnToFactory__c, CSS_Claims__c from CSS_Parts_Options__c where id =:prtsopnrec.id];
        system.debug('cp '+cp);
        
        List<CSS_SRT__c> lstSRT = new List<CSS_SRT__c>();
        CSS_SRT__c srt = new CSS_SRT__c();
        srt.SRT_ID__c = '00-10S-00';
        srt.CSS_Claims__c = testclaimsrec.id; 
        srt.Type__c = 'Diagnosis';
        srt.SRT_Type__c = 'Admin';
        srt.SRT_Warrantable__c = '100';
        srt.SRT_Title__c = 'Test';
        //srt.SRT_Category__c = 'Additional';
        srt.FailCode__c = 'TEST';
        srt.isPerformed__c = true;
        //srt.SRT_Time__c = '10.0';
        //srt.SRT_Quantity__c = '1';
        srt.Account_Code__c = 'CMP – Field Actions 65';
        srt.Account_Code_Description__c = 'Test';
        srt.Adjustment_Reason__c = 'Test';
        
        insert srt;
        
        CSS_SRT__c srtlist = new CSS_SRT__c();
        srtlist.SRT_ID__c = '00-10S-00';
        srtlist.CSS_Claims__c = testclaimsrec.id; 
        srtlist.Type__c = 'Diagnosis';
        srtlist.SRT_Type__c = 'Admin';
        srtlist.SRT_Warrantable__c = '100';
        srtlist.SRT_Title__c = 'Test';
        srtlist.SRT_Category__c = 'AdditionalDiag';
        srtlist.FailCode__c = 'TEST';
        srtlist.isPerformed__c = true;
        //srt.SRT_Time__c = '10.0';
        //srt.SRT_Quantity__c = '1';
        srtlist.Account_Code__c = 'CMP – Field Actions 65';
        srtlist.Account_Code_Description__c = 'Test';
        srtlist.Adjustment_Reason__c = 'Test';
        insert srtlist;
        
        list<String> stringList = new list<String>();
        String s = 'CMP – Field Actions 65;;'+solcompid+';;TEST';
        system.debug('stestclaimid'+stestclaimid);
        
        stringList.add(s);
        system.debug('stringList'+stringList);
        //stringList.add('N;;');stringList.add('true;;');stringList.add(stestclaimid);
        
		test.startTest();
        CG_CL_UpdateAccountCodeChildEntities.updateAccCode(stringList);
        test.stopTest();
    }
    static testmethod void testmethod2(){
        Account acc = new Account();
        acc.name='Kenworth Sales Co';
        acc.CSS_DistributorCode__c='02650';
        acc.IAM_Service_Provider_Code__c='97895';
        acc.type='Dealer Account';
        insert acc;
        CSS_Claims__c testclaimsRec = new CSS_Claims__c();
        
        testclaimsRec.Customer_Name__c='Test Customer';
        testclaimsRec.Customer_Code__c = '1234';
        testclaimsRec.Contact_Last_Name__c = 'T';
        testclaimsRec.Address__c = 'T';
        testclaimsRec.Customer_Contact_Phone__c = null;
        testclaimsRec.Email_Address__c = 'rp@sct.com';
        testclaimsRec.Status__c = 'Draft';
        testclaimsRec.TSR1__c = '1234';
        testclaimsRec.TSR2__c = '1234';
        testclaimsRec.TSR3__c = '1234';
        testclaimsRec.TSR4__c = '1234';
        testclaimsRec.TSR5__c = '1234';
        testclaimsRec.TSR6__c = '1234';
        testclaimsRec.TSR7__c = '1234';
        testclaimsRec.TSR8__c = '1234';
        testclaimsRec.TSR9__c = '1234';
        testclaimsRec.TSR10__c = '1234';
        testclaimsRec.Country__c = '1234';
        testclaimsRec.State__c = '1234';
        testclaimsRec.ZipCode__c = '12345-1234';
        testclaimsRec.PartReturnToCenter__c = 'Test';
        testclaimsRec.Account__c=acc.Id;
        //testclaimsRec.SP_INSHOP_LABOR_RATE__c='test';
        insert testclaimsRec;
        CSS_PSN__c psn = new CSS_PSN__c();
        psn.CSS_Claims__c = testclaimsRec.id;
        psn.Primary__c = true;
        insert psn;
        
        String stestclaimid = String.valueOf(testclaimsRec.Id);
        
        
        list<CSS_Solution_Component__c> lstsol = new list<CSS_Solution_Component__c>();
        CSS_Solution_Component__c solcomp = new CSS_Solution_Component__c();
        solcomp.Name='test';
        solcomp.Selected_Component__c=true;
        solcomp.AccountCode__c='65';
        solcomp.CSS_Claims__c=testclaimsRec.id;
        solcomp.Service_Job__c=null;
        solcomp.CoveredTravelMiles__c='5';
        solcomp.CoveredTravelLabor__c='6';
        solcomp.CoveredTowingMiles__c='3';
        solcomp.CoveredMealsLodgingAmt__c='7';
        //solcomp.Status__c='Approved';
        solcomp.CoveredLaborHrs__c='';
        solcomp.AccountCodeType__c ='CMP – Field Actions';
        solcomp.CampaignLaborPercentage__c='2';
        solcomp.Fail_Code_Editable__c ='TRP 2035-WUSSCB';
        solcomp.Type__c='test';
        
        lstsol.add(solcomp);
        CSS_Solution_Component__c solcomp1 = new CSS_Solution_Component__c();
        solcomp1.Name='test';
        solcomp1.Selected_Component__c=true;
        solcomp1.AccountCode__c='65';
        solcomp1.CSS_Claims__c=testclaimsRec.id;
        solcomp1.Service_Job__c=null;
        solcomp1.CoveredTravelMiles__c='';
        solcomp1.CoveredTravelLabor__c='6';
        solcomp1.CoveredTowingMiles__c='';
        solcomp1.CoveredMealsLodgingAmt__c='';
        solcomp.CoveredPartsQty__c='4';
        solcomp1.CoveredOCAmount__c='4';
        solcomp1.AccountCodeType__c ='CMP – Field Actions';
        solcomp1.CoveredTravelBaseFareAmt__c='2';
        solcomp1.Fail_Code_Editable__c ='TRP 2035-WUSSCB';
        solcomp1.Type__c='test';
        
        lstsol.add(solcomp1);
        insert lstsol;
        String solcompid = String.valueOf(solcomp.Id);
        List<CSS_Solution_Component__c> cs =[select id,Service_Job__c,CampaignLaborPercentage__c , CSS_Account_Formula__c,FailCode_Formula__c from CSS_Solution_Component__c where id =:solcomp.id];
        system.debug('lstsol '+cs);
        Id recTypeIdpart = css_utility.getRecordTypeId(CSS_Parts_Options__c.sObjectType, 'Parts');
        Id recTypeIdTTML = css_utility.getRecordTypeId(CSS_Parts_Options__c.sObjectType, 'TTML');
        Id recTypeIdOC = css_utility.getRecordTypeId(CSS_Parts_Options__c.sObjectType, 'OtherClaimables');
        CSS_Parts_Options__c prtsopnrec = new CSS_Parts_Options__c();
        prtsopnrec.RecordTypeId =recTypeIdpart;
        prtsopnrec.Account_Code__c = 'CMP – Field Actions 65';
        prtsopnrec.CSS_Claims__c = testclaimsrec.id;
        // prtsopnrec.ReturnWaiver__c = false;
        // prtsopnrec.ReturnToFactory__c = 'Test';
        prtsopnrec.City__c = 'Bangalore';
        prtsopnrec.Claimtype__c = 'Test';
        prtsopnrec.Comments__c = 'Test';
        prtsopnrec.Create_Date__c = '18092018';
        prtsopnrec.Fail_Code__c = 'TEST';
        prtsopnrec.Parts_Return__c = 'Test';
        prtsopnrec.ReturnToFactory__c = 'Y';
        prtsopnrec.ReturnWaiver__c = false;
        prtsopnrec.selected_part__c=true;
        prtsopnrec.Type__c = 'Commercial-Travel';
        //prtsopnrec.FailurepartId__c=solcomp1.id;
        insert prtsopnrec;
        CSS_Parts_Options__c prtsopnrec1 = new CSS_Parts_Options__c();
        prtsopnrec1.RecordTypeId =recTypeIdOC;
        prtsopnrec1.Account_Code__c = 'CMP – Field Actions 65';
        prtsopnrec1.CSS_Claims__c = testclaimsrec.id;
        // prtsopnrec.ReturnWaiver__c = false;
        // prtsopnrec.ReturnToFactory__c = 'Test';
        prtsopnrec1.City__c = 'Bangalore';
        prtsopnrec1.Claimtype__c = 'Test';
        prtsopnrec1.Comments__c = 'Test';
        prtsopnrec1.Create_Date__c = '18092018';
        prtsopnrec1.Fail_Code__c = 'TEST';
        prtsopnrec1.Parts_Return__c = 'Test';
        prtsopnrec1.ReturnToFactory__c = 'Y';
        prtsopnrec1.ReturnWaiver__c = false;
        prtsopnrec1.selected_part__c=true;
        //prtsopnrec.FailurepartId__c=solcomp1.id;
        insert prtsopnrec1;
        CSS_Parts_Options__c prtsopnrec2 = new CSS_Parts_Options__c();
        prtsopnrec2.RecordTypeId =recTypeIdTTML;
         prtsopnrec2.Type__c = 'Commercial-Travel';
        prtsopnrec2.Account_Code__c = 'CMP – Field Actions 65';
        prtsopnrec2.CSS_Claims__c = testclaimsrec.id;
        // prtsopnrec.ReturnWaiver__c = false;
        // prtsopnrec.ReturnToFactory__c = 'Test';
        prtsopnrec2.City__c = 'Bangalore';
        prtsopnrec2.Claimtype__c = 'Test';
        prtsopnrec2.Comments__c = 'Test';
        prtsopnrec2.Create_Date__c = '18092018';
        prtsopnrec2.Fail_Code__c = 'TEST';
        prtsopnrec2.Parts_Return__c = 'Test';
        prtsopnrec2.ReturnToFactory__c = 'Y';
        prtsopnrec2.ReturnWaiver__c = false;
        prtsopnrec2.selected_part__c=true;
        //prtsopnrec.FailurepartId__c=solcomp1.id;
        insert prtsopnrec2;
        CSS_Parts_Options__c prtsopnrec3 = new CSS_Parts_Options__c();
        prtsopnrec3.RecordTypeId =recTypeIdTTML;
         prtsopnrec3.Type__c = 'Non Commercial-Travel';
        prtsopnrec3.Account_Code__c = 'CMP – Field Actions 65';
        prtsopnrec3.CSS_Claims__c = testclaimsrec.id;
        // prtsopnrec.ReturnWaiver__c = false;
        // prtsopnrec.ReturnToFactory__c = 'Test';
        prtsopnrec3.City__c = 'Bangalore';
        prtsopnrec3.Claimtype__c = 'Test';
        prtsopnrec3.Comments__c = 'Test';
        prtsopnrec3.Create_Date__c = '18092018';
        prtsopnrec3.Fail_Code__c = 'TEST';
        prtsopnrec3.Parts_Return__c = 'Test';
        prtsopnrec3.ReturnToFactory__c = 'Y';
        prtsopnrec3.ReturnWaiver__c = false;
        prtsopnrec3.selected_part__c=true;
        //prtsopnrec.FailurepartId__c=solcomp1.id;
        insert prtsopnrec3;
        CSS_Parts_Options__c prtsopnrec4 = new CSS_Parts_Options__c();
        prtsopnrec4.RecordTypeId =recTypeIdTTML;
         prtsopnrec4.Type__c = 'Towing';
        prtsopnrec4.Account_Code__c = 'CMP – Field Actions 65';
        prtsopnrec4.CSS_Claims__c = testclaimsrec.id;
        // prtsopnrec.ReturnWaiver__c = false;
        // prtsopnrec.ReturnToFactory__c = 'Test';
        prtsopnrec4.City__c = 'Bangalore';
        prtsopnrec4.Claimtype__c = 'Test';
        prtsopnrec4.Comments__c = 'Test';
        prtsopnrec4.Create_Date__c = '18092018';
        prtsopnrec4.Fail_Code__c = 'TEST';
        prtsopnrec4.Parts_Return__c = 'Test';
        prtsopnrec4.ReturnToFactory__c = 'Y';
        prtsopnrec4.ReturnWaiver__c = false;
        prtsopnrec4.selected_part__c=true;
        //prtsopnrec.FailurepartId__c=solcomp1.id;
        insert prtsopnrec4;
        CSS_Parts_Options__c prtsopnrec5 = new CSS_Parts_Options__c();
        prtsopnrec5.RecordTypeId =recTypeIdTTML;
         prtsopnrec5.Type__c = 'Meals';
        prtsopnrec5.Account_Code__c = 'CMP – Field Actions 65';
        prtsopnrec5.CSS_Claims__c = testclaimsrec.id;
        // prtsopnrec.ReturnWaiver__c = false;
        // prtsopnrec.ReturnToFactory__c = 'Test';
        prtsopnrec5.City__c = 'Bangalore';
        prtsopnrec5.Claimtype__c = 'Test';
        prtsopnrec5.Comments__c = 'Test';
        prtsopnrec5.Create_Date__c = '18092018';
        prtsopnrec5.Fail_Code__c = 'TEST';
        prtsopnrec5.Parts_Return__c = 'Test';
        prtsopnrec5.ReturnToFactory__c = 'Y';
        prtsopnrec5.ReturnWaiver__c = false;
        prtsopnrec5.selected_part__c=true;
        //prtsopnrec.FailurepartId__c=solcomp1.id;
        insert prtsopnrec5;
        CSS_Parts_Options__c cp =[select id, FailurepartId__r.Service_Job__c, selected_part__c, ReturnWaiver__c, ReturnToFactory__c, CSS_Claims__c from CSS_Parts_Options__c where id =:prtsopnrec.id];
        system.debug('cp '+cp);
        
        List<CSS_SRT__c> lstSRT = new List<CSS_SRT__c>();
        CSS_SRT__c srt = new CSS_SRT__c();
        srt.SRT_ID__c = '00-10S-00';
        srt.CSS_Claims__c = testclaimsrec.id; 
        srt.Type__c = '99Time';
        srt.SRT_Type__c = 'Admin';
        srt.SRT_Warrantable__c = '100';
        srt.SRT_Title__c = 'Test';
        //srt.SRT_Category__c = 'Additional';
        srt.FailCode__c = 'TEST';
        srt.isPerformed__c = true;
        //srt.SRT_Time__c = '10.0';
        //srt.SRT_Quantity__c = '1';
        srt.Account_Code__c = 'CMP – Field Actions 65';
        srt.Account_Code_Description__c = 'Test';
        srt.Adjustment_Reason__c = 'Test';
        
        insert srt;
        
        CSS_SRT__c srtlist = new CSS_SRT__c();
        srtlist.SRT_ID__c = '00-10S-00';
        srtlist.CSS_Claims__c = testclaimsrec.id; 
        srtlist.Type__c = '99Time';
        srtlist.SRT_Type__c = 'Admin';
        srtlist.SRT_Warrantable__c = '100';
        srtlist.SRT_Title__c = 'Test';
        srtlist.SRT_Category__c = 'AdditionalDiag';
        srtlist.FailCode__c = 'TEST';
        srtlist.isPerformed__c = true;
        //srt.SRT_Time__c = '10.0';
        //srt.SRT_Quantity__c = '1';
        srtlist.Account_Code__c = 'CMP – Field Actions 65';
        srtlist.Account_Code_Description__c = 'Test';
        srtlist.Adjustment_Reason__c = 'Test';
        insert srtlist;
        
        list<String> stringList = new list<String>();
        String s = 'CMP – Field Actions 65;;'+solcompid+';;TEST';
         //String s1 = 'CMP – Field Actions 65;;'+solcomp1.Id+';;TEST';
        system.debug('stestclaimid'+stestclaimid);
         list<String> stringList1 = new list<String>();
        //String s = 'CMP – Field Actions 65;;'+solcompid+';;TEST';
         String s1 = 'CMP – Field Actions 65;;'+solcomp1.Id+';;TEST';
        stringList.add(s);
        stringList1.add(s1);
        system.debug('stringList'+stringList);
        //stringList.add('N;;');stringList.add('true;;');stringList.add(stestclaimid);
        
		test.startTest();
        CG_CL_UpdateAccountCodeChildEntities.updateAccCode(stringList);
         CG_CL_UpdateAccountCodeChildEntities.updateAccCode(stringList1);
        test.stopTest();
    }
}