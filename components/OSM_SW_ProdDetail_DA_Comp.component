<apex:component controller="OSM_SW_ProdDetail_DA_Comp_Ctrl">

<script type="text/javascript">
                CCRZ.uiProperties.productDetailView.desktop.tmpl='CMI-SW-ProductDetail-Desktop';
                CCRZ.uiProperties.aggregateView.desktop.aggContent.tmpl='CMI-SW-ProductDetail-Aggregate-Desktop';
                CCRZ.uiProperties.aggregateView.desktop.tmpl='CMI-SW-ProductDetail-Aggregate-Desktop';
                 
                
</script> 
 
<style>
    
.messagingSection-rfq-Error{
    background-color: red;
    margin: 1%;
    font-size: 15px;
    color: white;
 }
.CMI-divTableCell, .CMI-divTableHead{
    padding: 0px 0px;
}
.CMI-ItalicText{
    font-style: italic;   
 }
.CMI-Invoice-Message{
    margin-top: 1%;
 }
.CMI-login-btn{
    float: right;
    margin-right: 3rem;
    margin-top: 1rem;
}
.disable-link{
    pointer-events: none;
}
a {
    color: teal;
    text-decoration: none;
}
    
a:hover {
    color: teal;
    text-decoration: underline;
}
.totalcalCost{
    margin-top: 7px!important;
    font-weight: bold;
    font-size: 13px;
    }
 .btn-info:focus, .btn-info.focus{
     background-color: teal;
     outline-color: teal;
 }

.btn-info:active, .btn-info.active, .open>.dropdown-toggle.btn-info {
    color: #fff;
    background-color: teal;
    border-color: teal;
    outline-color: teal;
}

.btn:active, .btn.active {
    background-image: none;
   /* outline: 0;*/
    -webkit-box-shadow: inset 0 0px 0px rgba(0, 0, 0, 0);
    box-shadow: inset 0 0px 0px rgba(0,0,0,0);
}

.btn-info:active:hover, .btn-info.active:hover, .open>.dropdown-toggle.btn-info:hover, .btn-info:active:focus, .btn-info.active:focus, .open>.dropdown-toggle.btn-info:focus, .btn-info:active.focus, .btn-info.active.focus, .open>.dropdown-toggle.btn-info.focus {
    color: #fff;
    background-color: teal;
    border-color: teal;
    outline-color: teal;
}

.product-detail-sec{
    outline:none;
}
.rfq-margin-top{
    margin-top:1rem;
}

.col-md-1-x {
    float: left;
    width: 16%;
    text-align: center;
}

button-div{
    font-size: 18px;
    color: black;
    text-align: center;
    border: 1px solid #ccc;
    background: white;
    padding: 1px 1px 1px 1px;
    margin-left: 2%;
    border-radius: 5px;
    width: 15%;
}

.rfq-disappear{
    display : none !important;
}
.CMI-tnc-text{    
    margin: 4rem;
    margin-top: 2rem;
}
.tnc-text-align{
    text-align: center;
 }
 .CMI-checkbox-freetrail{
    margin-left: 33px;
    padding-top: 0px;
 }
    
 .CMI-checkbox-RFQ{
    margin-left: 30px;
    padding-top: 0px;
 }
    
.CMI-Margin-top{
    margin-top: 5px;
 }
</style>
    
 
<script id="CMI-SW-ProductDetail-Desktop" type="text/template">
   <div class="panel panel-default product_detail_container product_type_standard phoneProductItem cc_panel cc_product_detail_container cc_product_type_standard">
    <div class="CMI-Invoice-Message" style="background-color: palegoldenrod;padding: 10px;border: solid 2px #ffae42;display:none">      
        <span class="icon-Info" style="color:#ffae42; font-size:13px; background-color:palegoldenrod"></span> &nbsp;All Cummins online subscriptions will invoice according to the billing period set.<span id="productname2"></span>
    </div>
    <div class="panel-heading cc_heading"> 
     <h3 class="panel-title cc_title">{{this.product.prodBean.name}}</h3>
    </div>
    <div class="panel-body product_detail cc_body cc_product_detail" >
     <div class="messagingSection-Error" role="alert" style="display: none"></div>
     <div class="messagingAction-Info" role="alert" style="display: none">
      <button type="button" class="close cc_close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
     </div>
     <div class="row">
      <div class="col-md-6">
          {{#ifDisplay 'PD.DsplSDesc'}}
         <div class="CMI-Product-Detail-ShortDes">
          <p class="pblock cc_pblock">{{{this.product.prodBean.shortDesc}}}</p>
         </div>
        {{/ifDisplay}}
        
        
       <div class="prod_media cc_prod_media">
        {{#if this.mediaWrappers.[SVG Interactive Diagram]}}
         {{#each this.mediaWrappers.[SVG Interactive Diagram]}}
          <div class="interactive cc_interactive">{{displaySVG this 'mainProdImage prodDetail img-responsive'}}</div>
         {{/each}}
        {{/if}}
        <div id="altImageModal" class="modal fade cc_alt_image_modal" tabindex="-1" role="dialog">
         <div class="modal-dialog cc_modal-dialg" role="document">
          <div class="modal-content cc_modal-content">
           <div class="modal-header cc_modal-header">
            <button type="button" class="close cc_close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
            <h4 class="modal-title cc_modal-title" id="myModalLabel"></h4>
           </div>
           <div class="modal-body cc_modal-body">
            <img class="modalImg cc_modal_img" src=""/>
            <p class="modalText cc_modal_text"></p>
           </div>
          </div>
         </div>
        </div>
       </div>            
            
        {{#if this.product.mediaWrapper }}
         <div class="cc_product_detail_photo_container" id="photoContainer">
          <div class="row">
           <div class="col-md-12">
            <div class="cc_main_prod_image"  style=" width: 65%; margin-left: 65px;">{{displayImage this.product.mediaWrapper 'mainProdImage prodDetail img-responsive'}}</div>
           </div>
          </div>
          {{#if this.mediaWrappers.[Alternate Images]}}
           <div class="row">
            {{#each this.mediaWrappers.[Product Image]}}
             <div class="col-xs-3">
              <img class="alternate cc_alternate img-responsive thumbnail" src="{{productImage this}}" data-id="{{this.uri}}"/>
             </div>
            {{/each}}
            {{#each this.mediaWrappers.[Alternate Images]}}
             <div class="col-xs-3">
              <img class="alternate cc_alternate img-responsive thumbnail" src="{{productImage this}}" data-id="{{this.uri}}"/>
             </div>
            {{/each}}
           </div>
          {{/if}}
         </div>
        {{else}}
         {{#if this.mediaWrappers.[SVG Interactive Diagram]}}
         {{else}}
    
                <div class="cc_product_detail_photo_container" id="photoContainer">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="cc_main_prod_image img-responsive">{{displayImage this.product.mediaWrapper 'mainProdImage prodDetail'}}</div>
                        </div>
                    </div>                
                </div>
            
         {{/if}}
        {{/if}}
              
       <div class="product_detail_item wishFinder cc_wish_finder " data-sku="{{this.product.prodBean.sku}}" id="CMI-LongDescAlignment">
     
            <div class="CMI-longdesc-wrap LongDesc CMI-Product-Detail-LongDes">         
                <span class="value cc_value">{{{this.product.prodBean.longDesc}}}</span>
            </div>
                
            <input type="button" class="CMI-more-button" style="color:teal;" onclick="$('.product-detail-sec')[0].focus()" value="More Details" />
        
        </div> <!-- END OF LONG Description -->
       
     </div>
      
       <!-- DIV column for Subscription package -->
     
         <div id="subscriptionPackageId" class="col-md-6">        
           <div class="subsContainer" ></div>   
            <div class="aggSection"></div>         
         </div>
     </div>
    
     
    </div>
   
   </div> <!-- END OF MAIN DIV -->
   <div class="widgetSection"></div>
  <div class="product-detail-sec" tabindex="1">
    <div class="panel panel-default widget_container secRelatedRelated_container cc_panel cc_secRelatedRelated_container">
    <div class="panel-heading cc_heading">
     <h3 class="panel-title cc_title">{!$label.OSM_ProdDetail_About} {{this.product.prodBean.name}}</h3>
    </div>
    <div class="panel-body cc_body">
        <div class="LongDesc CMI-Product-Detail-LongDes">
        <span class="">{{{this.product.prodBean.longDesc}}}</span>
           </div>
    </div>
   </div>
  
  </div>
  </script>

  <script id="CMI-SW-ProductDetail-Aggregate-Desktop" type="text/template">
  
  </script>
  
<script id="CMI_ProductDetail-SubscPackage-Desktop" type="text/template">
    
    {{#ifEquals this.errorOnPageLoad false}}
      <div id="GOMSPriceMsg" style="width: 100%;height: 100%;padding-left: 2%;margin-bottom: 0px;padding-top: 0px;padding-bottom: 2px;display:none;white-space: normal;">
       <div style="background-color: palegoldenrod;padding: 10px;border: solid 2px #ffae42;">
                                                                                                                          
        <span class="icon-Info" style="color:#ffae42; font-size:13px; background-color:palegoldenrod"></span> &nbsp; Prices shown here are for illustration purposes only. Please refer to the Global Order Management System (GOMS) and your local ERP to view accurate pricing and invoices.
        </div>
      </div>
        {{#ifEquals this.header false}}
            <div class="CMI-SES-sub-head row CMI-SES-subscription">{!$label.OSM_ProdDetail_Package}</div>
         {{/ifEquals}}
         {{#ifEquals this.header true}}
            <div class="CMI-SES-sub-head row CMI-SES-subscription">{!$label.OSM_ProdDetail_Features}</div>
         {{/ifEquals}}
        <div class="row cc_qty_control_row CMI-Subsc-Pkg" >
            
        </div>
        <input type="hidden" name="compositKeyForSubProdTerm" value="{{this.compositKeyForSubProdTerm}}" />
        <input type="hidden" name="hasTnC" value="{{this.hasTnC}}" />
        <input type="hidden" name="subProdTermsMap" value="{{this.wrapper.subProdTermsMap}}" />
        <input type="hidden" name="subProdTermPrices" value="{{this.subProdTermPrices}}" />
        <input type="hidden" name="proratedPrice" value="{{this.proratedPrice}}" />
        <input type="hidden" name="prodYearPrice" value="{{this.prodYearPrice}}" />
        <input type="hidden" name="prodMonthlyPrice" value="{{this.prodMonthlyPrice}}" />
        <input type="hidden" name="totalPrice" value="" />
        <input type="hidden" name="hasActiveSubs" value="{{this.hasActiveSubs}}" />
        <input type="hidden" name="isSubscribed" value="{{this.isSubscribed}}" />
        <input type="hidden" name="hasOtherProductSusbcription" value="{{this.hasOtherProductSusbcription}}" />   
        <input type="hidden" name="GOMSUser" value="{{this.GOMSUser}}" />       
        
        
        <input type="hidden" name="pricePerBillFrequency" value="{{this.pricePerBillFrequency}}" />        
        <input type="hidden" name="compParentId" value="" />
        <input type="hidden" name="subslength" value="" />
         <div class="CMI-DA-table">
                    <input type="hidden" name="compProdPrice" class="sellerIDSelected" value="" />
                    {{#ifEquals this.onlyBase false}}
                    <input type="hidden" name="buttonName" value="" />
                    <div class="CMI-DA-table-body">
                          <div class="row CMI-DA-table-row"> 
                          <div class="CMI-DA-table-cell-image">&nbsp;</div> 
                          <div class="CMI-DA-table-cell-name CMI-ImageDiv">&nbsp;</div> 
                         {{#eachInMap this.productIdVsWrapperMap}}
                                <div class="CMI-DA-table-cell-{{value.buttonName}}">
                                    
                                  {{#ifEquals value.buttonDisabled false}}
                                    <button type="button" data-sku="{{value.sku}}" data-price="{{value.prodSubscriptionPriceYearly}}" data-button="{{value.buttonName}}" id="{{value.buttonName}}" class="btn btn-info CMI-ProdName-Btn">{{value.buttonName}}</button>
                                    {{/ifEquals}}
                                    {{#ifEquals value.buttonDisabled true}}
                                        <button type="button" data-sku="{{value.sku}}" data-price="{{value.prodSubscriptionPriceYearly}}" disabled data-button="{{value.buttonName}}" id="{{value.buttonName}}" class="btn btn-info CMI-ProdName-Btn">{{value.buttonName}}</button>
                                    {{/ifEquals}}
                                    
                                            <input type="hidden" name="{{value.name}}" class="sellerIDSelected" value="{{value.prodSubscriptionPriceYearly}} : {{value.sku}}" />
                                  </div>
                              {{/eachInMap}}
                              
                           </div>  
                        
                              {{#eachInMap this.specificationsName}}
                             
                            <div class="row CMI-DA-table-row">
                                <div class="CMI-DA-table-cell-image"><span class="CMI-Subscription-Icons">{{value.imageText}}</span></div>
                                <div class="CMI-DA-table-cell-name ">{{value.specName}}</div>
                                <div id="baseColor" class="CMI-DA-table-cell-Base CMI-baseColor {{value.displayBaseDiv}}">{{#ifEquals value.base 'True'}}<span class="{{value.imagecss}}">=</span>{{/ifEquals}}{{#ifNotEquals value.base 'True'}}&nbsp;{{/ifNotEquals}}</div>
                                <div id="plusColor" class="CMI-DA-table-cell-Plus CMI-plusColor {{value.displayPlusDiv}}">{{#ifEquals value.plus 'True'}}<span class="{{value.imagecss}}">=</span>{{/ifEquals}}{{#ifNotEquals value.base 'True'}}&nbsp;{{/ifNotEquals}}</div>
                                <div id="proColor" class="CMI-DA-table-cell-Pro CMI-proColor {{value.displayProDiv}}" >{{#ifEquals value.pro 'True'}}<span class="{{value.imagecss}}">=</span>{{/ifEquals}}{{#ifNotEquals value.base 'True'}}&nbsp;{{/ifNotEquals}}</div>
                                
                           </div>
                        
                    {{/eachInMap}}
                                                                                                        
                </div>
                {{/ifEquals}}
                {{#ifEquals this.onlyBase true}}
                    {{#eachInMap this.productIdVsWrapperMap}}
                        <input type="hidden" name="productSkuSelected" class="productSkuSelected" value="{{value.sku}}" />
                        <input type="hidden" name="buttonName" class="buttonName" value="{{value.buttonName}}" />
                        
                    {{/eachInMap}}
                    {{#eachInMap this.specificationsName}}
                             
                            <div class="row CMI-DA-table-row">
                                <div class="CMI-DA-table-cell-image"><span class=" CMI-Subscription-Icons2 {{value.imageText}}"></span></div>
                                <div class="CMI-DA-table-cell-name ">{{value.specName}}</div>
                                <div id="baseColor" class="CMI-DA-table-cell-Base CMI-baseColor {{value.displayBaseDiv}}"></div>
                                <div id="plusColor" class="CMI-DA-table-cell-Plus CMI-plusColor {{value.displayPlusDiv}}"></div>
                                <div id="proColor" class="CMI-DA-table-cell-Pro CMI-proColor {{value.displayProDiv}}" ></div>
                                
                           </div>
                        
                    {{/eachInMap}}
                {{/ifEquals}}
         </div>
         
         {{#ifEquals this.isGuestLoginButton true}}
            <div class="CMI-login-btn">
                <div style="display: flex; margin-bottom: 10px">
                    <span style="padding-top: 8px; padding-right: 10px"><I>{{pageLabelMap 'Product_Detail_Login_msg'}}</I></span>
                    <button type="button" class="btn btn-sm CMI-DA-Packages goToLogin" id="goToLogin">{{pageLabelMap 'Product_Detail_Login'}}</button>
                </div>
                    
                <div style="float: right; display: flex">
                    <span>{{pageLabelMap 'Product_Detail_New_User'}}</span>
                    <a href="{!$Label.OSM_Register_DA_App_URL}" ><span style="color: teal; text-decoration: underline;">{{pageLabelMap 'Product_Detail_Register'}}</span></a>
                </div>                
                
            </div>
        {{/ifEquals}}
        
        {{#ifEquals this.isFreeProduct true}}
                {{#ifEquals this.freeProductDAmsg true}}
                   <!-- <div class="DA-API-Message" >{{this.daMessage}}</div>-->
                    {{#ifEquals this.DAExceptionFlag false}} <div class="col-md-8 CMI-Margin-top row DA-Guest-User CMI-DA-current" >{{this.daMessage}}</div> {{/ifEquals}}
                
                    {{#ifEquals this.DAExceptionFlag true}} <div class="col-md-8 row CMI-Margin-top DA-Guest-User CMI-DA-current" >{{this.DaExceptionMessage}}</div> {{/ifEquals}}
                {{/ifEquals}}
                
                {{#ifEquals this.freeProductDAcount true}}
                    <div class="col-xs-6 col-md-5" style="padding-top:10px">
                          <div class="col-xs-6 col-md-7 CMI-DA-current" style="width:66%">{{pageLabelMap 'CurrentSubscription'}}</div>
                          <div class="col-xs-6 col-md-4 CMI-DA-current-number" style="padding-bottom: 2px;"> {{this.totalSubscriptionCount}}</div>
                      </div>
                      <div class="col-xs-6 col-md-5" style="padding-top:10px">
                          <div class="col-xs-6 col-md-7 CMI-DA-active" style="width:66%; padding-left:0px">{{pageLabelMap 'AvailableSubscription'}}</div>
                          <div class="col-xs-6 col-md-4 CMI-DA-active-number" style="padding-bottom: 2px;"> {{this.availableCount}}</div>
                      </div>
                {{/ifEquals}}
        
        {{/ifEquals}}
        {{#ifEquals this.isGuest false}}
        
        {{#ifEquals this.subscriptionSetting false}}
                
            <div >
               <div class="CMI-SES-sub-head row CMI-SES-subscription">{!$label.OSM_ProdDetail_Eligibility}</div>
                {{#ifEquals this.DAExceptionFlag false}} <div class="col-md-8 DA-Guest-User CMI-DA-current" >{{this.daMessage}}</div> {{/ifEquals}}
                
                {{#ifEquals this.DAExceptionFlag true}} <div class="col-md-8 DA-Guest-User CMI-DA-current" >{{this.DaExceptionMessage}}</div> {{/ifEquals}}
                
              </div>
        {{/ifEquals}}
         {{#ifEquals this.subscriptionSetting true}}
           <div class="product_detail_item wishFinder cc_wish_finder margin-lrem" >
                    
               <!-- DA Specifications options  --> 
        <div class="CMI-subsetting">
           <div class="CMI-SES-sub-head row CMI-SES-subscription">{!$label.OSM_ProdDetail_Subscription}</div>
          <div>
              <form class="form-horizontal">              
                  <fieldset>

            <!-- Number of Bundles -->
                    <div class="form-group">
                      {{#ifEquals this.isSubscribed true}}
                      <label class="col-xs-5 col-md-4 control-label CMI-SES-Bundles" Id="NumberofSubscription" for="bundles"><B>{{pageLabelMap 'Buy more Subscriptions'}}</B></label>
                      {{/ifEquals}}
                      {{#ifEquals this.isSubscribed false}}
                      <label class="col-xs-5 col-md-4 control-label CMI-SES-Bundles" Id="NumberofSubscription" for="bundles"><B>{{pageLabelMap 'Number of Subscription'}}</B></label>
                      {{/ifEquals}}
                      <div class="col-xs-6 col-md-2">
                        <input type="text" id="subcQty" name="subcQty" value="" class="subcQty input-text entry plus_minus cc_entry form-control" maxlength="7" />
                      </div>
                      <div class="col-xs-6 col-md-5">
                          <div class="col-xs-6 col-md-8 CMI-DA-current" style="text-align:right">{{pageLabelMap 'CurrentSubscription'}}</div><div class="col-xs-6 col-md-4 CMI-DA-current-number" style="padding-bottom: 2px"> {{this.totalSubscriptionCount}}</div>
                      </div>
                      <div class="col-xs-6 col-md-5">
                          <div class="col-xs-6 col-md-8 CMI-DA-active" style="text-align:right">{{pageLabelMap 'AvailableSubscription'}}</div><div class="col-xs-6 col-md-4 CMI-DA-active-number" style="padding-bottom: 2px"> {{this.availableCount}}</div>
                      </div>
                      <div class="col-xs-12 col-md-12 subscriptionError" style="text-align: center; display:none;">
                        <div style="color:red">{!$label.OSM_ProdDetail_Quantity}</div>
                        </div>
                    </div>

            <!-- Subscription Length - Multiple Radios (inline) -->
                    <div class="form-group">
                        
                      <label class="col-xs-5 col-md-4 control-label" for="radios"><B>{{pageLabelMap 'Subscription Length'}}</B></label>
                        
                      <div class="col-md-6"> 
                          {{#eachInMap this.subscriptionLengthVsYrMultipler}}
                                    <label class="radio-inline" for="{{key}}">
                                      <input type="radio" class="CMI-SubsLength" {{status}} {{value}} name="subscriptionLengthLst" data-subslength="{{key}}" data-multipler="{{value}}" id="{{key}}" value="{{value}}">{{key}}</input>
                                </label>
                               {{/eachInMap}}
                          
                         <!-- {{#ifEquals this.isSubscribed true}}
                          <span class="radio-inline CMI-ItalicText">{{pageLabelMap 'Expires '}} <span class="cc_col_order_date"  >{{this.subsEndDate}}</span></span>
                            {{/ifEquals}}-->
                       </div> 
                       <div class="col-md-6" style="padding-left:81px;padding-top:10px;">
                        {{#ifEquals this.isSubscribed true}}
                          <span ><B>{{pageLabelMap 'Expiration Date'}}</B></span ><span style="padding-left:1px;" title="All subscriptions for a location will be co-termed to end on the same date and the price will be pro-rated depending on the number of days left in your current active subscription" >&#128712;</span>
                          <span style="padding-left:45px;" class="cc_col_order_date"  >{{this.subsEndDate}}</span>
                            {{/ifEquals}}
                    </div>
                    </div>
                    
            <!-- Billing Period - Multiple Radios (inline) -->
                    <div class="form-group">
                      <label class="col-xs-5 col-md-4 control-label" for="radios"><B>{{pageLabelMap 'Billing Period'}}</B></label>
                      <div class="col-xs-6 col-md-8"> 
                      
                        {{#eachInMap this.billingFrequencies}}
                            <label class="radio-inline" for="{{value}}">
                                 <input type="radio" id="{{value}}" class="CMI-BillingFreq" name="billingFreq" value="{{value}}" />{{value}}
                            </label>
                        {{/eachInMap}}
                
                        
                
                      </div>
                    </div>
                    
                <!-- Cost Per Subscription -->
                    <div class="costSubscription"></div>                
                <!-- Total Cost -->
                <div class="totalCostPerYear"></div>
                   
            </fieldset>                  
        </form>
      </div>  
    </div>    {{#ifNotEquals this.isGuest true}}
                    {{#ifEquals this.isTnC true}}
                    <div class="row CMI-tncSec">
                    <div class="col-md-8 pull-left">
                            <div class="action cc_action pull-right">
                                 <div class="checkbox">
                                  <label for="termAndCondition" class="cc_est_shipping_label">
                                   <input id="termAndCondition" type="checkbox" name="termAndCondition" class="boxes cc_ship_complete" value="true" />
                                   {{pageLabelMap 'OSM_TnC_Accept'}} &nbsp; 
                                    <a class='termsNCondTab' >{{pageLabelMap 'OSM_TnC_Text'}}</a> 
                          </label>
                                                        
                                
                            
                                 </div>
                          </div>
                        </div>
                    </div>
                    {{/ifEquals}}
                {{/ifNotEquals}}
                <div class="row">
                <div class="col-md-8 pull-right">
                        <div class="action cc_action pull-right">
                            <div class="onSuccessAddToCart" style="color: green; background: yellow; background-color: rgb(243, 220, 190);  padding: 10px;  border: 2px solid rgb(59, 214, 30); color: black;   font-size: 13px;   background-color: palegoldenrod; display:none; padding-left: 30px; ">
                                 <div style="content: '';position: absolute; border-color: #009933;border-style: solid;border-width: 0 0.25em 0.25em 0;height: 1em;/* top: 1.3em; *//* left: 22.6em; *//* margin-top: -1em; */transform: rotate(45deg);width: 0.5em;display: inherit;/* padding: 13px; */margin-left: -15px;/* float: left;"></div>{{pageLabelMap 'CartInc_AddedToCart'}}</div>
                            <input type="hidden" name="sellerIDSelected" class="sellerIDSelected" value="{{this.product.sellerID}}" />
                            <input type="hidden" name="productSkuSelected" class="productSkuSelected" value="" />
                             
                             <button type="button" class="btn btn-info" id="processAddToCart" >{!$label.OSM_ProdDetail_Cart}</button>
                        </div>
                         
                    </div>
                   
                </div>
                          <div class="CMI-Product-Detail-Links">
                            <div class="rfqError" style="color: red; display:none ">{!$label.OSM_ProdDetail_values} </div>
                            <div class="rfqSuccess" style="color: green; display:none ">{!$label.OSM_ProdDetail_Request}<br/>
                                                                                       {!$label.OSM_ProdDetail_Representative}</div>
                            <div class="freeTrialSuccess" style="color: green; display:none "></div>
                          <a href="#quoteModalError" id="quoteLinkError" class="CMI-link-icons cc_rfq_link quoteLinkError"><span class="CMI-text-icons">m</span>{!$label.OSM_ProdDetail_Request_Quote}</a>
                          <a href="#quoteModal" id="quoteLink" class="CMI-link-icons cc_rfq_link" data-placement="top" data-toggle="modal"><span class="CMI-text-icons">m</span>{!$label.OSM_ProdDetail_Request_Quote}</a>
                          <a href="#" class="CMI-link-icons OSM-Free-Trial" id="FreeTrialLink" onclick="return false;"><span class="CMI-text-icons">+</span>{{pageLabelMap 'FreeTrial_Label'}}</a>  
                        
                        
                        </div>
                         <div id="GOMSMsg" style="width: 100%;height: 100%;padding-left: 2%;margin-bottom: -15px;padding-top: 50px;display:none">
                                                                                          
                            <div style="background-color: palegoldenrod;padding: 10px;border: solid 2px #ffae42;">
                                                                                                                  
                            <span class="icon-Info" style="color:#ffae42; font-size:13px; background-color:palegoldenrod"></span> &nbsp; Please contact your Cummins distributor/sales representative to purchase this product.
                            </div>
                        </div>
        </div> 
        {{/ifEquals}}
        
         {{/ifEquals}}
         
         
         
         
         <!-- Modal -->
<div id="FreeTrialModel" class="modal fade cc_modal cc_cart_rfq_modal" role="dialog">
  <div class="modal-dialog" style="margin-left: 32%;" role="document">
     <div class="modal-content cc_modal_content" style="width: 51rem;">
     <input type="hidden" name="FreeTrialMaxQuantity" id="FreeTrialMaxQuantity"  value="{{this.freeTrialDetails.finalAvailableCount}}" />
     <input type="hidden" name="FreeTrialFreeDays" id="FreeTrialFreeDays"  value="{{this.freeTrialDetails.freeDays}}" />
     <input type="hidden" name="FreeTrialProduct" id="FreeTrialProduct"  value="{{this.freeTrialDetails.productId}}" />
      <div class="modal-header CMI-DA-Packages cc_modal_header">
       <button type="button" class="close cc_close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
       <h4 class="modal-title cc_modal_title" id="CartRfqLabel">{{pageLabelMap 'FreeTrial_Label'}}</h4>
      </div>
      
      <!-- <div class="modal-body cc_modal_body">-->
       <div class="messagingSection-FreeTrial-Error messagingSection-Error" style="display: none">
        <div class="alert alert-danger" id="ErrorMsgDenger"></div>
       </div>
       <form id="freetrialForm" class="cc_cart_email_form">
       
       
        <div class="col-md-12 mb-3 rfq-margin-top">
                      <label for="FirstName"><B>{{pageLabelMap 'FreeTrial_Productname'}}&#58;&#160;</B></label><label ><B> {{this.freeTrialDetails.productName}} </B></label>
                </div>
                <div class="form-group">
                <div class="col-md-12 mb-3 rfq-margin-top">
                  <label for="Email"><B>{{pageLabelMap 'FreeTrial_Quantity'}}&#58;&#160;</B></label>
                  <input type="text" class="form-control freeTrialQuantity-cls" id="MaximumFreeQty" value="{{this.freeTrialDetails.finalAvailableCount}}">
                </div>
                                                   
               
                                                   
         </div>
         <div class="row" />
         <label  style="font-size: 12px;padding-left: 4%;padding-top: 1%;" >{{pageLabelMap 'FreeTrial_Max_Number_of_Subscription'}}&#58;&#160;{{this.freeTrialDetails.finalAvailableCount}}</label>
            <div class="form-group">
                                                
                
                  <div class="col-md-12 mb-3 rfq-margin-top">
                      <label for="FirstName"><B>{{pageLabelMap 'FreeTrial_SubscriptionLength'}}&#58;&#160;</B></label>
                     <!-- Start : Juhi Changes : Change in length for Subscription length and addition of 'days' -->
                     <p><label class="form-control" id="freeDays"  style="width:8%;display:inline-block;margin-right: 5px;text-align: center;">{{ this.freeTrialDetails.freeDays}}</label> {!$label.OSM_SubscriptionExp_Days}</p>
                <!-- End : Juhi Changes : Change in length for Subscription length and addition of 'days' -->
                                                   </div>
                
                
            </div>
               <div class="row" />                                   
            
         
         
             
             
         
            <div class="form-group ">
               
                
            </div>
            <div class="row" />
            <div class="form-group ">
              
            </div>
            
            <div class="row">
                    <div class="col-md-x pull-left">
                            <div class="action cc_action pull-right">
                                 <div class="CMI-checkbox-freetrail checkbox">
                                  <label for="termAndConditionFreeTrial" class="cc_est_shipping_label">
                                   <input id="termAndConditionFreeTrial" type="checkbox" name="termAndConditionFreeTrial" class="boxes cc_ship_complete" value="true" />
                                   {{pageLabelMap 'OSM_TnC_Accept'}} &nbsp; <a class='termsNCondTab' >{{pageLabelMap 'OSM_TnC_Text'}}</a>
                                  </label>
                                 </div>
                                      
                            </div>
                        </div>
                    </div>
            
       </form>
       
      <div class="modal-footer rfq-margin-top">
       <button id="startFreeTrial_submit" class="btn " disabled >{{pageLabelMap 'FreeTrial_Start_Free_Trial'}}</button>
       <button type="button" class="btn CMI-DA-Packages " data-dismiss="modal" aria-label="Close" >{{pageLabelMap 'FreeTrial_Cancel'}}</button>
      </div>
     </div>
    </div>
</div>


    
        <div id="quoteModal" class="modal fade cc_modal cc_cart_rfq_modal" tabindex="-1" role="dialog" aria-labelledby="CartRfqLabel">
    <div class="modal-dialog" style="margin-left: 10%;" role="document">
     <div class="modal-content cc_modal_content" style="width: 100rem;">
     <input type="hidden" name="availableCount" class="availableCount" value="{{this.availableCount}}" />
      <div class="modal-header CMI-DA-Packages cc_modal_header">
       <button type="button" class="close cc_close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
       <h4 class="modal-title cc_modal_title" id="CartRfqLabel">{{pageLabelMap 'CartRFQForm_Header'}}</h4>
      </div>
        <div class="messagingSection-rfq-Error" style="background-color: #FEEEED;padding: 10px;border: solid 2px red;display:none;">
            <span class="icon-Warning" style="color:red; font-size:18px; vertical-align: middle;"></span>&nbsp;{{pageLabelMap 'RFQ_GENERIC_ERROR_MSG'}}
        </div>
        <form id="rfqForm" class="cc_cart_email_form">
       
            <div class="form-group">
                                                   
                  <div class="col-md-6 mb-3 rfq-margin-top">
                      <label for="FirstName"><B>{!$label.OSM_ProdDetail_FirstName}</B></label>
                       <label class="form-control" id="FirstName" >{{ this.detail.FirstName}}</label>
                </div>
                
                <div class="col-md-6 mb-3 rfq-margin-top">
                  <label for="LastName"><B>{!$label.OSM_ProdDetail_LastName}</B></label>
                  <label class="form-control" id="LastName" >{{ this.detail.LastName}}</label>
                </div>
            </div>
                                                   
            <div class="form-group">
                <div class="col-md-6 mb-3 rfq-margin-top">
                  <label for="Email"><B>{!$label.OSM_ProdDetail_Email}</B></label>
                  <label class="form-control" id="Email" >{{ this.detail.Email}}</label>
                </div>
                                                   
                <div class="col-md-6 mb-3 rfq-margin-top">
                  <label for="Phone"><B>{!$label.OSM_Template_PhoneNumber}</B></label>
                  <label class="form-control" id="Phone" >{{ this.detail.Phone}}</label>
                </div>
                                             
         </div>
         <div class="form-group">
                <div class="col-md-6 mb-3 rfq-margin-top">
                  <label for="Address"><B>{!$label.OSM_ProdDetail_CompAddress}</B></label>
                  <label class="form-control" style = "height:7rem;" id="Address" >{{ this.detail.Address}}</label>
                </div>
                
                <div class="col-md-6 mb-3 rfq-margin-top">
                  <label for="Email"><B>{!$label.OSM_ProdDetail_QuoteRequested}</B></label>
                  <label class="form-control RequestedDate" id="RequestedDate" >{{ this.detail.requestedDate}}</label>
                </div>
                
             </div>
             
              <div class="form-group">
                
                
                <div class="col-md-12 mb-3 rfq-margin-top">
                     <label for="rfqQ_description"><B>{!$label.OSM_ProdDetail_Comment}</B></label>
                 <textarea id="rfqQ_description" rows="3" type="text" style="max-width: 100%; min-width: 100%;" class="form-control" name="rfqQ_description"></textarea>
                </div>
                
                
         </div>
            <div class="form-group ">
               <div class="col-md-12 CMI-DA-Packages rfq-margin-top">
                          <div class="col-md-1-x" style="width:19%"><B>{!$label.OSM_RFQ_Temp_Product} </B></div>
                          <div class="col-md-1-x" style="width:19%"><B>{!$label.OSM_ProdcutLine_Quantity}</B></div>
                          <div class="col-md-1-x" style="width:19%"><B>{{pageLabelMap 'AvailableSubscription'}}</B></div>
                          <div class="col-md-1-x " style="width:19%"><B>{!$label.OSM_ProdDetail_Length}</B></div>
                          <div class="col-md-1-x" style="width:19%"><B>{!$label.OSM_ProdDetail_UnitPrice}</B></div>
                </div>
                
            </div>
            <div class="row" />
            <div class="form-group ">
               <div class="col-md-12 rfq-margin-top">
                      <div class="col-md-1-x Product" style="width:19%">{!$label.OSM_RFQ_Temp_Product}</div>
                      <div class="col-md-1-x rfq-quantity" style="width:19%"><B>{!$label.OSM_ProdcutLine_Quantity}</B></div>
                      <div class="col-md-1-x Equipment" style="width:19%">{{pageLabelMap 'AvailableSubscription'}}</div>
                      <div class="col-md-1-x rfq-subscription" style="width:19%">{!$label.OSM_ProdDetail_Length}</div>
                      <div class="col-md-1-x UnitPrice" style="width:19%"><B>{!$label.OSM_ProdDetail_UnitPrice}</div>
                </div>
            </div>
            <div class="row" />
       </form>
      <!--</div>-->
      
      <div class="modal-footer rfq-margin-top">
       <div class="submitProcessing" style="margin-right: 6%; display:none;" >{{pageLabelMap 'SUBMIT_PROCESSING'}}</div>
       <button id="submitRFQ" class="btn CMI-DA-Packages" >{{pageLabelMap 'RequestForQuoteForm_Submit'}}</button>
       <button type="button" class="btn CMI-DA-Packages " data-dismiss="modal" aria-label="Close" >{!$label.OSM_ProdDetail_Cancel}</button>
      </div>
     </div>
    </div>
   </div>
               
             <!-- TnC Modal start -->
               <div id="tncModalPopup" class="modal fade cc_modal cc_cart_rfq_modal" tabindex="-1" role="dialog" aria-labelledby="tncLabel">
                <div class="modal-dialog" style="margin-left: 25%;" role="document">
                 <div class="modal-content cc_modal_content" style="width: 100rem;" id="TnCNewTab"> 
                  <div class="modal-header CMI-DA-Packages cc_modal_header">
                   <button type="button" class="close cc_close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
                   <h4 class="modal-title cc_modal_title tnc-text-align" id="tncFormLabel">{{pageLabelMap 'OSM_TnC_Header'}}</h4>
                  </div>
                   <div class="messagingSection-tnc-Error" style="display: none"></div>
                   <form id="tncForm" class="cc_cart_email_form">
                        
                        <div class="form-group">
                           <div class="CMI-tnc-text" >
                                                 <b>  {{this.TnCText}}</b>
                            </div>
                        </div>
                        
                        <div class="modal-footer rfq-margin-top">
                        <button type="button" class="btn CMI-DA-Packages " data-dismiss="modal" aria-label="Close" >{!$label.OSM_ProdDetail_Cancel}</button>
                      </div>
                    </form>
                              
                </div>
               </div>
               
            </div>
            <!--Tnc Modal end-->
            

   
    {{/ifEquals}}   
                                                   
    {{#ifEquals this.errorOnPageLoad true}}      
       <div class="col-md-8 row CMI-Margin-top DA-Guest-User CMI-DA-current" >{{pageLabelMap 'Product_Detail_Error_Message'}}</div>
    {{/ifEquals}}
    
        <div class="modal fade cc_modal cc_myaccount_orders_modal" id="ShowWarningMsgID" tabindex="-1" role="dialog" aria-labelledby="CancelMod">
            <div class="modal-dialog" role="document">
                <div class="modal-content cc_modal_content" style="border-radius:1px;border:1px black;">
                    <div class="modal-header" style="color: #fff;background-color: black;border-color: black;">
                        <h4 class="modal-title cc_modal_title" id="CartRfqLabel">Shopping Cart</h4>
                    </div>
                    <div class="modal-body cc_modal_body">
                        <b>{!$Label.OSM_ProdDetail_Warning_Msg}</b>
                    </div>
                    <div class="modal-footer">
                        <input type="button" class="closeModal btn btn-default cc_add_coupon" style="background-color: #0f4f77;" id="hideModelOnCancel2" data-dismiss="modal" value="Ok" />
                    </div>
                </div>
            </div>
        </div>                                                   
</script>    
  
<script type="text/javascript">
        
    $('#jklink').attr('href','http://smashingmagazine.com');
    
        function goToRegister()
        {
            //window.location.href =  "{!$Label.OSM_Register_App_URL}";
            window.location.href =  "{!$Label.OSM_Register_DA_App_URL}";
            return true;
        }
        
    var productTnCLink = '';
        var validateFreeTrialDone = false;
        
    jQuery(function($){

                    CCRZ.subsc = CCRZ.subsc||{};
                    CCRZ.models.RFQModel = CCRZ.CloudCrazeModel.extend({
                    className : "OSM_SW_ProdDetail_DA_Comp_Ctrl",
                    saveSubsInModel:function(ccData,callback){
                    this.invokeContainerLoadingCtx($('body'),"saveCCPackageInClass",JSON.Stringify(ccData),
                        function(response){
                        if(response && response.success){ alert('--Got the response---')}
                        },{buffer:false,escape:false,nmsp:false} );
                    }
                    });
                    
                    CCRZ.views.RFQPackageView = CCRZ.CloudCrazeView.extend({
                    viewName :'RFQPackageView',
                    className : "OSM_SW_ProdDetail_DA_Comp_Ctrl",
                    templateDesktop : CCRZ.util.template('rfqModalTemplate'),
                    templatePhone : CCRZ.util.template('rfqModalTemplate'),
                    firstRender : false,
                    init : function(){
                    this.dataSet = new Object();
                    var modals = this.dataSet;
                    var detail = new Object();
                    detail.FName = '{!$User.FirstName}';
                    detail.LName = '{!$User.LastName}';
                    detail.Company = '{!$User.CompanyName}';
                     this.dataSet.Detail = detail;
                     console.log(this.dataSet);
                    
                    },
                    
                    renderDesktop : function(){
                        this.setElement($('.rfqModal'));
                        this.$el.html(this.templateDesktop(this.dataSet));
                    },
                    renderPhone : function(){
                        this.setElement($('.rfqModal'));
                        this.$el.html(this.templateDesktop(this.dataSet));
                    },
                    
                    });
                    
                    CCRZ.RFQPackageView = new CCRZ.views.RFQPackageView({
                        model: CCRZ.models.RFQPackageModel
                    });
                    CCRZ.models.SubscriptionPackageModel = CCRZ.CloudCrazeModel.extend({
                    className : "OSM_SW_ProdDetail_DA_Comp_Ctrl",
                    saveSubsInModel:function(ccData,callback){
                    this.invokeContainerLoadingCtx($('body'),"saveCCPackageInClass",JSON.Stringify(ccData),
                        function(response){
                            if(response && response.success){ alert('--Got the response---')}
                                },{buffer:false,escape:false,nmsp:false} );
                            }
                        });
                    
                    CCRZ.views.SubscriptionPackageView = CCRZ.CloudCrazeView.extend({
                    viewName :'SubscriptionPackageCCView',
                    className : "OSM_SW_ProdDetail_DA_Comp_Ctrl",
                    templateDesktop : CCRZ.util.template('CMI_ProductDetail-SubscPackage-Desktop'),
                    templatePhone : CCRZ.util.template('CMI_ProductDetail-SubscPackage-Desktop'),
                    firstRender : false,
                    init : function(){
                         this.dataSet = new CCRZ.models.SubscriptionPackageModel();
                         console.log(this.dataSet);
                         this.fetchProdDetailInfoForDA();
                         this.render();                    
                    },
                    events:{
                        "click #saveCCPackage" : "saveMyPackage",
                        "click #processAddToCart" : "processAddItem",
                        "click .CMI-ProdName-Btn" : "processSelectProd",
                        "click .CMI-SubsLength" : "processSelectSubsLength",
                        "click .CMI-BillingFreq" : "processSelectBillingFreq",
                        "onchange .subcQty" : "calculateTotal",
                        'change .subcQty' : 'processSelectNoOfSubsc',
                        'click #quoteLink' : 'openRFQModal',
                        'click #submitRFQ' : 'rfqSubmit',
                        'click #startFreeTrial_submit' : 'freetrialSubmit',
                        'click .quoteLinkError' : 'quoteLinkError',
                        'click .goToLogin' : 'goToLogin',
                        'click .OSM-Free-Trial' : 'openFreeTrialModel',
                        'click .termsNCondTab' : 'openTnCModal',
                        'click #termAndCondition' : 'tncOnchange',
                        'click #termAndConditionFreeTrial' : 'tncOnchangeFreeTrial',
                        'click #termAndConditionRFQ' : 'tncOnchangeRFQ',
                        
                        'change .freeTrialQuantity-cls' : 'validateFreeTrial'
                        
                        
                    },
                    renderDesktop : function(){
                        this.setElement($('.subsContainer'));
                        this.$el.html(this.templateDesktop(this.dataSet));
                    },
                    renderPhone : function(){
                        this.setElement($('.subsContainer'));
                        this.$el.html(this.templateDesktop(this.dataSet));
                    },
                    updateButtonsModal : function(modalfromAggregateView) {
                          var v = this;
                          this.dataSet.wrapper = modalfromAggregateView;
                          console.log('Test here'+modalfromAggregateView);
                          CCRZ.SubscriptionPackageModel = this.dataSet;

                },
                    saveMyPackage:function(event){
                    },
                    tncOnchange : function(){
                        console.log(1);
                        if( $('input[id="termAndCondition"]:checked').val() != undefined ){
                            var tncValue = JSON.parse($('input[id="termAndCondition"]:checked').val());
                            
                            var subslength = $('input[name="subslength"]').val();
                            var selectedSku = $('input[name="productSkuSelected"]').val();
                            var billingFreq = $('input[name="billingFreq"]:checked').val();

                                if(tncValue){
                                    var subslength = $('input[name="subslength"]').val();
                                    var qty=$('input[name="subcQty"]').val();
                                    var availableCount=$('input[name="availableCount"]').val();
                                    var selectedSku = $('input[name="productSkuSelected"]').val();
                                     var billingFreq = $('input[name="billingFreq"]:checked').val();
                                     var GOMSUser=$('input[name="GOMSUser"]').val();
                                     console.log('GOMS>>>>>'+GOMSUser);
                                    if((subslength != undefined && selectedSku != undefined && billingFreq != undefined && qty != undefined && qty>0 && availableCount >0) || ("{!$Label.OSM_DA_API_VALIDATION}" != 'true' && qty>0)){
                                        console.log('insideif>>>');
                                        
                                        if(GOMSUser=='true')
                                         {
                                            $('#processAddToCart').attr('disabled', true);
                                            console.log('Step4>>>');
                                         }
                                         else
                                         {
                                            $('#processAddToCart').attr('disabled', false);
                                            $('#processAddToCart').addClass('CMI-DA-Packages');
                                            
                                            console.log('Step5>>>');
                                         }
                                        //$('#processAddToCart').attr('disabled', false);
                                     }
                                }
                                console.log(JSON.parse($('input[id="termAndCondition"]').val()));
                        }else{
                                $('#processAddToCart').attr('disabled', true);
                                 $('#processAddToCart').removeClass('CMI-DA-Packages');
                        }
                    },
                    tncOnchangeFreeTrial : function(){
                        if($('input[id="termAndConditionFreeTrial"]:checked').val() != undefined){
                                if(validateFreeTrialDone )
                                {
                                    $('#startFreeTrial_submit').attr('disabled', false);
                                    $('#startFreeTrial_submit').addClass('CMI-DA-Packages');
                                 }
                        }else{
                                $('#startFreeTrial_submit').attr('disabled', true);
                                 $('#startFreeTrial_submit').removeClass('CMI-DA-Packages');
                        }
                       },
                     tncOnchangeRFQ : function(){
                    },
                    goToLogin : function(event){
                         if (CCRZ.pagevars.currentCartID){
                          cartParam = CCRZ.pagevars.currentCartID;
                         }else{
                          cartParam = "";
                         }
                         
                         var urlArgument = '';
            
                        if(CCRZ.pagevars.currentPageURL.search("\\?refURL") >= 0)
                            urlArgument = CCRZ.pagevars.currentPageURL.split("?refURL")[0];
                        if(CCRZ.pagevars.currentPageURL.search("&refURL") >= 0)
                            urlArgument = CCRZ.pagevars.currentPageURL.split("&refURL")[0];
                        
                        if("{!$Label.OSM_Login_Include_https}" == 'true' && !urlArgument.includes('https://')){
                            urlArgument = 'https://'+urlArgument;
                        }
                            
                        if("{!$Label.OSM_Login_Include_https}" != 'true' && urlArgument.includes('https://')){
                                urlArgument = urlArgument.replace('https://','');                    
                            }
                         window.location.href =  "{!$Label.OSM_Login_App_Url}" + '&retURL='+urlArgument;
                       },
                       
                       openFreeTrialModel:function()
                       {
                            console.log("Free trial alert");                            
                            $('#FreeTrialModel').modal('show');
                            $(".messagingSection-FreeTrial-Error").css("display", "none");
                                $("#ErrorMsgDenger").html("");
                       },
                       
                        // Start : Juhi Changes : Terms and Conditions Popup to open in a new tab - No CSS
                        openTnCModal : function(){
                            console.log("T n C Modal");                            
                            console.log('prodID : ' + CCRZ.detailData.jsonProductData.uid);

                            var baseUrl = '{!$Site.BaseUrl}';
                            console.log('baseUrl : '+baseUrl);
                            
                            // when using Document with Document Link in label
                            $('.termsNCondTab').attr('href','{!$Label.OSM_TnC_Product_PDF_Link}');
                            
                            $('.termsNCondTab').attr('target','_blank');

                            
                        },
                         // End : Juhi Changes : Terms and Conditions Page to open in a new tab   
                        validateFreeTrial:function(event)
                        {
                            
                            var maxQuantity = $('input[name="FreeTrialMaxQuantity"]').val() != undefined ? $('input[name="FreeTrialMaxQuantity"]').val() : 0;
                            var enterQuantity =  $('input[id="MaximumFreeQty"]').val();
                            enterQuantity = enterQuantity.trim();
                            console.log(maxQuantity);
                            console.log(enterQuantity);
                            console.log(maxQuantity < enterQuantity);
                            // debugger;
                            if(maxQuantity < 1)
                            {
                                $(".messagingSection-FreeTrial-Error").css("display", "block");
                                $("#ErrorMsgDenger").html("{!$Label.OSM_SW_Free_Trial_QuantityValidation3}");
                                validateFreeTrialDone = false;
                                $('#startFreeTrial_submit').attr('disabled', true);
                                 $('#startFreeTrial_submit').removeClass('CMI-DA-Packages');
                            }
                            else if(enterQuantity == "")
                            {
                                $(".messagingSection-FreeTrial-Error").css("display", "block");
                                $("#ErrorMsgDenger").html("{!$Label.OSM_SW_Free_Trial_QuantityValidation}");
                                validateFreeTrialDone = false;
                                $('#startFreeTrial_submit').attr('disabled', true);
                                 $('#startFreeTrial_submit').removeClass('CMI-DA-Packages');
                            }
                            else if(isNaN(enterQuantity))
                            {
                                $(".messagingSection-FreeTrial-Error").css("display", "block");
                                $("#ErrorMsgDenger").html("{!$Label.OSM_SW_Free_Trial_ValidQuantityValidation}");
                                validateFreeTrialDone = false;
                                $('#startFreeTrial_submit').attr('disabled', true);
                                 $('#startFreeTrial_submit').removeClass('CMI-DA-Packages');
                            }
                            else if(maxQuantity < Number(enterQuantity) ||  Number(enterQuantity) <= 0)
                            {
                                $(".messagingSection-FreeTrial-Error").css("display", "block");
                                $("#ErrorMsgDenger").html("{!$Label.OSM_SW_Free_Trial_MaxNumberOfSubsc} "+maxQuantity);
                                validateFreeTrialDone = false;
                                $('#startFreeTrial_submit').attr('disabled', true);
                                 $('#startFreeTrial_submit').removeClass('CMI-DA-Packages');
                            }
                            else
                            {
                                console.log($('input[id="termAndConditionFreeTrial"]').prop("checked"));
                                if($('input[id="termAndConditionFreeTrial"]').prop("checked")){
                                
                                
                                    $('#startFreeTrial_submit').attr('disabled', false);
                                    $('#startFreeTrial_submit').addClass('CMI-DA-Packages');
                                     
                                    
                                 
                                }else{
                                        $('#startFreeTrial_submit').attr('disabled', true);
                                         $('#startFreeTrial_submit').removeClass('CMI-DA-Packages');
                                }
                                validateFreeTrialDone = true;
                                $(".messagingSection-FreeTrial-Error").css("display", "none");
                                    $("#ErrorMsgDenger").html("");
                               
                            }
                        },
                        
                        
                       freetrialSubmit:function(event)
                       {
                            var maxQuantity = $('input[name="FreeTrialMaxQuantity"]').val() != undefined ? $('input[name="FreeTrialMaxQuantity"]').val() : 0;
                            var enterQuantity =  $('input[id="MaximumFreeQty"]').val();
                            enterQuantity = enterQuantity.trim();
                            console.log(maxQuantity);
                            console.log(enterQuantity);
                            console.log(maxQuantity < enterQuantity);
                            debugger;
                            if(maxQuantity < 1)
                            {
                                $(".messagingSection-FreeTrial-Error").css("display", "block");
                                $("#ErrorMsgDenger").html("{!$Label.OSM_SW_Free_Trial_QuantityValidation3}");
                                validateFreeTrialDone = false;
                                $('#startFreeTrial_submit').attr('disabled', true);
                                 $('#startFreeTrial_submit').removeClass('CMI-DA-Packages');
                                
                            }
                            else if(enterQuantity == "")
                            {
                                $(".messagingSection-FreeTrial-Error").css("display", "block");
                                $("#ErrorMsgDenger").html("{!$Label.OSM_SW_Free_Trial_QuantityValidation}");
                                validateFreeTrialDone = false;
                                $('#startFreeTrial_submit').attr('disabled', true);
                                 $('#startFreeTrial_submit').removeClass('CMI-DA-Packages');
                            }
                            else if(isNaN(enterQuantity))
                            {
                                $(".messagingSection-FreeTrial-Error").css("display", "block");
                                $("#ErrorMsgDenger").html("{!$Label.OSM_SW_Free_Trial_ValidQuantityValidation}");
                                validateFreeTrialDone = false;
                                $('#startFreeTrial_submit').attr('disabled', true);
                                 $('#startFreeTrial_submit').removeClass('CMI-DA-Packages');
                            }
                            else if(maxQuantity < Number(enterQuantity) ||  Number(enterQuantity) <= 0)
                            {
                                $(".messagingSection-FreeTrial-Error").css("display", "block");
                                $("#ErrorMsgDenger").html("{!$Label.OSM_SW_Free_Trial_MaxNumberOfSubsc} "+maxQuantity);
                                validateFreeTrialDone = false;
                                $('#startFreeTrial_submit').attr('disabled', true);
                                 $('#startFreeTrial_submit').removeClass('CMI-DA-Packages');
                            }
                            else
                            {
                                validateFreeTrialDone = true;
                                $(".messagingSection-FreeTrial-Error").css("display", "none");
                                $("#ErrorMsgDenger").html("");
                                var remoteCall = _.extend(CCRZ.RemoteInvocation,{className:'OSM_SW_ProdDetail_DA_Comp_Ctrl'});
                                console.log(remoteCall);
                                
                                var myObject = new Object();
                                myObject.maxQuantity = maxQuantity;
                                myObject.enteredQuantity = enterQuantity;
                                myObject.freeDays = $('input[name="FreeTrialFreeDays"]').val() != undefined ? $('input[name="FreeTrialFreeDays"]').val() : 0;
                                myObject.productId = $('input[name="FreeTrialProduct"]').val() != undefined ? $('input[name="FreeTrialProduct"]').val() : '';
                                myObject.tncCheck = $('input[id="termAndConditionFreeTrial"]:checked').val() != undefined ? JSON.parse($('input[id="termAndConditionFreeTrial"]:checked').val()):false;
                                $('#startFreeTrial_submit').attr('disabled', true);
                                $('#startFreeTrial_submit').removeClass('CMI-DA-Packages');
                                console.log(myObject); 
                                var myString = JSON.stringify(myObject);
                                remoteCall.invokeCtx('submitFreeTrial', myString, function(resp){
                                console.log(resp);
                                try{
                                    if (resp.success){                   
                                            console.log('SUCCESS');
                                            console.log(resp);
                                            $('#FreeTrialModel').modal('hide');
                                            $("#FreeTrialLink").css("display", "none");
                                            // Juhi - Sept 24 - Changes made to add 'Assign Subscription' link when free trial is initiated.
                                            $('.freeTrialSuccess').html(resp.data + '<br><a href={!$label.OSM_AssignSubscription_Link}>Assign Free Trial Subscriptions</a>');
                                            $('.freeTrialSuccess').css("margin-top", "14px");    
                                            
                                            $(".freeTrialSuccess").css("display", "block");
                                        
                                        }else
                                        {
                                            $(".messagingSection-FreeTrial-Error").css("display", "block");
                                            $("#ErrorMsgDenger").html(resp.data);
                                            $('#startFreeTrial_submit').attr('disabled', false);
                                            $('#startFreeTrial_submit').addClass('CMI-DA-Packages');
                                        }
                                        
                                    }
                                    
                                    catch(err)
                                    {
                                        $(".messagingSection-FreeTrial-Error").css("display", "block");
                                        $("#ErrorMsgDenger").html(err);
                                        $('#startFreeTrial_submit').attr('disabled', false);
                                        $('#startFreeTrial_submit').addClass('CMI-DA-Packages');
                                    }
                                },{ buffer : false, escape : false , nmsp:false });
                                
                                
                                
                            }
                             
                       },
                       
                    fetchProdDetailInfoForDA:function(){
                    var view = this;
                    var model = this.dataSet;
                    var parentId = CCRZ.detailData.jsonProductData.uid;
                        var param = CCRZ.pagevars.portalUserId != '' ? CCRZ.pagevars.portalUserId +'/'+parentId : '{!$User.Id}' +'/'+parentId;
                    console.log(param);
                    $('input[name="compParentId"]').val(parentId);
                    this.dataSet.wrapper = new Object();
                     console.log(model);
                     this.invokeContainerLoadingCtx($('body'),"fetchProdDetailInfoForDA",param,
                        function(result,event){
                         if(event.status){ 
                            try{
                            console.log(CCRZ.detailData.jsonProductData.product.prodBean.OSMDAFreeProduct);
                            console.log(result.data);
                            model.errorOnPageLoad = false;
                            if(result.data.productIdVsWrapperMap === undefined || result.data.sortedProdSpecification === undefined
                                || result.data.subscriptionLengthVsYrMultipler === undefined || result.data.billingFrequencies=== undefined){
                                    model.errorOnPageLoad = true;
                                }
                            model.productIdVsWrapperMap = result.data.productIdVsWrapperMap;
                            model.header = result.data.onlyBase;
                            model.onlyBase = result.data.onlyBase;
                            model.isFreeTrialAvailabel = result.data.isFreeTrialAvailabel;
                            model.specificationsName = result.data.sortedProdSpecification;
                            model.subscriptionLengthVsYrMultipler = result.data.subscriptionLengthVsYrMultipler;
                            model.billingFrequencies = result.data.billingFrequencies;
                            model.availableCount = result.data.availableCount;
                            model.daMessage = result.data.daMessage;
                                
                            model.totalSubscriptionCount = result.data.totalSubscriptionCount;
                            model.isGuest = false;
                            model.isFreeProduct = CCRZ.detailData.jsonProductData.product.prodBean.OSMDAFreeProduct;
                            model.isGuestLoginButton = CCRZ.pagevars.isGuest;
                            model.freeTrialDetails = result.data.freeTrialDetails;
                            model.DAExceptionFlag = result.data.DAExceptionFlag;
                            model.DaExceptionMessage = '{!($Label.OSM_SW_Cart_Subsc_validation)}';
                                // JUHI Changes - Sept 26 - Terms and Conditions PDF in different tab
                                console.log('result.data.productTnCLink : ' + result.data.productTnCLink);
                                productTnCLink = result.data.productTnCLink;
                            if(result.data.GOMSUser!=undefined)
                            {
                                model.GOMSUser=result.data.GOMSUser;
                                console.log('GOMS User>>>>>'+model.GOMSUser);
                            }
                            else{
                            model.GOMSUser=false;
                            console.log('GOMS User>>>>>'+model.GOMSUser);
                            
                            }
                            if(result.data.GOMSPriceMsg!=undefined)
                            {
                                model.GOMSPriceMsg=result.data.GOMSPriceMsg;
                                console.log('GOMS User>>>>>'+model.GOMSUser);
                            } 
                            if(model.DAExceptionFlag){
                                }
                            model.isTnC = true;
                            if(model.isFreeTrialAvailabel)
                            {
                                validateFreeTrialDone = true;
                                model.freeTrialDetails.productName = CCRZ.detailData.jsonProductData.product.prodBean.name;
                            
                                if(model.availableCount < model.freeTrialDetails.maximumQty)
                                    model.freeTrialDetails.finalAvailableCount = model.availableCount;
                                else
                                    model.freeTrialDetails.finalAvailableCount = model.freeTrialDetails.maximumQty;
                            }
                            
                            if(result.data.isSubscribed){
                                model.isTnC = false;
                                model.subsEndDate = result.data.subscriptionEndDate;
                            }
                            
                            model.TnCText = CCRZ.detailData.jsonProductData.product.prodBean.OSMTermandCondition;
                            if(CCRZ.pagevars.isGuest || CCRZ.detailData.jsonProductData.product.prodBean.OSMDAFreeProduct){
                                model.isGuest = true;
                                model.onlyBase = true;
                            }
                            model.subscriptionSetting = true;
                            model.hasActiveSubs = result.data.hasActiveSubs;
                            model.isSubscribed = false;
                            model.hasOtherProductSusbcription = result.data.hasOtherProductSusbcription;    
                            if(result.data.hasActiveSubs && result.data.isSubscribed){
                                model.isSubscribed = true;
                            }
                            
                            model.freeProductDAmsg = false;
                            model.freeProductDAcount = false;
                            if(CCRZ.detailData.jsonProductData.product.prodBean.OSMDAFreeProduct && !CCRZ.pagevars.isGuest){
                                $("#FreeTrialLink").css("display", "none");
                                if(model.totalSubscriptionCount == 0 && model.availableCount == 0 && "{!$Label.OSM_DA_API_VALIDATION}" == 'true'){
                                    model.freeProductDAmsg = true;
                                    if(model.daMessage=='' && model.isFreeProduct){
                                            model.daMessage = '{!($Label.OSM_SW_Cart_Subsc_validation)}';
                                        }
                                }else{
                                    model.freeProductDAcount = true;
                                    
                                }
                            }
                            else
                            {
                                if(!model.isFreeTrialAvailabel || CCRZ.pagevars.isGuest) 
                                {
                                     $("#FreeTrialLink").css("display", "none");
                                }
                            }
                            
                            
                            //Start:Added by Vaibhav on 15-Aug
                            if(model.daMessage!='' && "{!$Label.OSM_DA_API_VALIDATION}" == 'true')
                            {
                                model.subscriptionSetting = false;
                                model.header = true;
                            }
                            //End:Added by Vaibhav on 15-Aug
                          
                          
                            if(model.totalSubscriptionCount == 0 && model.availableCount == 0 && "{!$Label.OSM_DA_API_VALIDATION}" == 'true'){
                                    model.subscriptionSetting = false;
                                    model.header = true;
                                }
                                if(model.DAExceptionFlag && "{!$Label.OSM_DA_API_VALIDATION}" == 'true'){
                                    model.subscriptionSetting = false;
                                    model.header = true;
                                    model.DaExceptionMessage = '{!($Label.OSM_SW_Cart_Subsc_validation)}';
                                }
                                
                                for (var key in model.specificationsName) {
                                    if(model.totalSubscriptionCount == 0 && model.availableCount == 0 && "{!$Label.OSM_DA_API_VALIDATION}" == 'true'){
                                        model.specificationsName[key].imagecss = 'CMI-Subscription-Icons';
                                    }else{
                                        model.specificationsName[key].imagecss = 'CMI-Icons';
                                    }
                                }
                                for (var key in model.productIdVsWrapperMap) {
                                    console.log(model.productIdVsWrapperMap[key]);
                                    if(model.totalSubscriptionCount == 0 && model.availableCount == 0 && "{!$Label.OSM_DA_API_VALIDATION}" == 'true'){
                                        model.productIdVsWrapperMap[key].buttonDisabled = true;
                                    }else{
                                        model.productIdVsWrapperMap[key].buttonDisabled = false;
                                    }
                                }
                                
                                console.log(model.productIdVsWrapperMap);
                            
                            model.pricePerBillFrequency = JSON.stringify(result.data.pricePerBillFrequency);
                             model.prodYearPrice = JSON.stringify(result.data.prodYearPrice);
                                model.proratedPrice = JSON.stringify(result.data.proratedPriceMap);
                                model.proratedDnPrice = result.data.proratedDnPriceMap;
                            model.compositKeyForSubProdTerm = JSON.stringify(result.data.compositKeyForSubProdTerm);
                            model.subProdTermPrices = JSON.stringify(result.data.subProdTermPrices);
                            model.prodMonthlyPrice = JSON.stringify(result.data.prodMonthlyPrice);
                            if(!CCRZ.pagevars.isGuest){
                                var detail = new Object();
                                //result.data.userDetail.contactId
                                //Commented be Vaibhav 13-7-2018
                                detail.FirstName = result.data.userDetail.fName != undefined ?result.data.userDetail.fName:'';
                                detail.LastName = result.data.userDetail.lName != undefined ?result.data.userDetail.lName:'';
                                detail.Email = result.data.userDetail.email != undefined ?result.data.userDetail.email:'';
                                detail.Company = result.data.userDetail.company != undefined ?result.data.userDetail.company:'';
                                detail.Phone = result.data.userDetail.phone != undefined ?result.data.userDetail.phone:'';
                                detail.Address = result.data.userDetail.strAddress != undefined ?result.data.userDetail.strAddress:'';
                                detail.requestedDate = result.data.userDetail.requestedDate!= undefined ?result.data.userDetail.requestedDate:'';
                                model.detail = detail;
                            }
                            }catch(e){console.log(e);
                                model.errorOnPageLoad = true;      
                            }
                        var wrapper = new Object(); 
                        
                         view.render();
                         $('input[name="pricePerBillFrequency"]').val(model.pricePerBillFrequency);
                         CCRZ.subsPackageView.render();
                         
                        $('#startFreeTrial_submit').attr('disabled', true);
                        $('#startFreeTrial_submit').removeClass('CMI-DA-Packages');
                         if(result.data.existingCartItem != undefined && result.data.existingCartItem && result.data.existingCartItem.monthlyPrice != undefined){
                              var plan = 'Base';
                               var availableCount = result.data.availableCount;
                                var monthlyPrice = result.data.existingCartItem.monthlyPrice;
                                $('input[name="totalPrice"]').val(result.data.existingCartItem.totalPrice);
                                 $( "div.Product" ).replaceWith('<div class="col-md-1-x Product" style="width:19%"><B>'+CCRZ.detailData.jsonProductData.product.prodBean.name+'</B></div>');
                                 $( "div.Plan" ).replaceWith('<div class="col-md-1-x Plan" style="width:19%"><B>'+plan+'</B></div>');
                                 $( "div.Equipment" ).replaceWith('<div class="col-md-1-x Equipment" style="width:19%"><B>'+availableCount+'</B></div>');
                                 $( "div.UnitPrice" ).replaceWith('<div class="col-md-1-x UnitPrice" style="width:19%"><B> $'+monthlyPrice.toFixed(2)+'</B></div>');
                                 $( "div.rfq-quantity" ).replaceWith('<div class="col-md-1-x rfq-quantity" style="width:19%"><B>'+result.data.existingCartItem.quantity+'</B></div>');
                                 $( "div.rfq-subscription" ).replaceWith('<div class="col-md-1-x rfq-subscription" style="width:19%"><B>'+result.data.existingCartItem.subsLength+'</B></div>');
                      
                             
                             //$('#processAddToCart').attr('disabled', false);
                             if(model.GOMSUser)
                             {
                                $('#processAddToCart').attr('disabled', true);
                             }
                             else
                             {
                                $('#processAddToCart').attr('disabled', false);
                             }
                            if(result.data.existingCartItem.quantity != undefined && result.data.existingCartItem.quantity){
                                $('input[name="subcQty"]').val(result.data.existingCartItem.quantity);
                            }
                            if(result.data.existingCartItem.subsLength != undefined && result.data.existingCartItem.subsLength){
                                for (var key in model.subscriptionLengthVsYrMultipler) {
                                    if(key == result.data.existingCartItem.subsLength){
                                        
                                        $('input[id="'+key+'"]').prop('checked', true);
                                       
                                        $('input[name="subslength"]').val(key);
                                    }
                                }
                                
                                console.log('model.subscriptionLengthVsYrMultipler');
                                console.log(model.subscriptionLengthVsYrMultipler);
                            }
                             $(".CMI-Invoice-Message").css("display", "none");
                            if(result.data.existingCartItem.billingFreq != undefined && result.data.existingCartItem.billingFreq){
                               
                                if(!result.data.isSubscribed && result.data.existingCartItem.billingFreq !='One Time'){
                                    $(".CMI-Invoice-Message").css("display", "block");
                                }
                            for(jj = 0; jj < model.billingFrequencies.length; jj++){
                                    var key = model.billingFrequencies[jj];
                                    if(key == result.data.existingCartItem.billingFreq){
                                        $('input[id="'+key+'"]').prop('checked', true);
                                        }
                                    }
                            }
                            
                            if(result.data.existingCartItem.totalPrice != undefined && result.data.existingCartItem.totalPrice){    
                                $( "div.totalCostPerYear" ).replaceWith('<div class="form-group totalCostPerYear"><label class="col-xs-5 col-md-4 control-label" for="radios"><B>Total Cost</B></label><div class="col-xs-6 col-md-8"> <div class="totalcostCal costPerYear "><B> '+CCRZ.pagevars.currencyData.currencySymbol+''+result.data.existingCartItem.totalPrice.toFixed(2) +' '+result.data.existingCartItem.frequency+'</B></div><div></div>');
                                
                            }
                            
                            if(result.data.existingCartItem.amount != undefined && result.data.existingCartItem.amount){    
                                $( "div.costSubscription").replaceWith( '<div class="form-group costSubscription"><label class="col-xs-5 col-md-4 control-label" for="radios"><B>Cost Per Subscription</B></label><div class="col-xs-6 col-md-8"><div class="costCalPerYear costPerYear"> '+CCRZ.pagevars.currencyData.currencySymbol+''+result.data.existingCartItem.amount.toFixed(2) +' '+result.data.existingCartItem.frequency+'</div> </div></div>');
                                
                            }
                            
                         }
                         if(result.data.hasActiveSubs && result.data.isSubscribed){
                             $('input:radio[name=subscriptionLengthLst]').prop('checked', true);
                            $('input:radio[name=subscriptionLengthLst]').prop('disabled', true);
                            
                            for (var key in model.subscriptionLengthVsYrMultipler) {
                                $('input[name="subslength"]').val(key);
                                break;
                            }
                              for (var key in model.subscriptionLengthVsYrMultipler) {
                                  if(key == "{!$Label.OSM_Subscription_Length_1_Year}"){
                                    $('input[id=Yearly]').prop('disabled', true);
                                }
                            }
                            //'Buy more Subscription';
                         }
                         
                         
                         if(CCRZ.detailData.jsonProductData.product.prodBean.OSMDAFreeProduct){
                        $("#FreeTrialLink").css("display", "none");
                        }
                        else
                        {
                            if(!model.isFreeTrialAvailabel || CCRZ.pagevars.isGuest) 
                            {
                                console.log("in part");
                                 $("#FreeTrialLink").css("display", "none");
                            }
                        }
                         
                         if(!model.onlyBase){
                         $("input[type=radio]").attr('disabled', true);
                         $("input[name='subcQty']").attr('disabled', true);
                         }
                         $('#processAddToCart').attr('disabled', true);
                          $('#baseColor').removeClass('baseColor');
                            $('#plusColor').removeClass('plusColor');
                            $('#proColor').removeClass('proColor');
                            $("#quoteLink").css("display", "none");
                            $(".quoteLinkError").css("display", "block");
                            $(".quoteLinkError").addClass('disable-link');
                             if(result.data.existingCartItem != undefined && result.data.existingCartItem && result.data.existingCartItem.totalPrice && result.data.existingCartItem.totalPrice != undefined){
                                 if(model.GOMSUser)
                                 {
                                    $('#processAddToCart').attr('disabled', true);
                                 }
                                 else
                                 {
                                    $('#processAddToCart').attr('disabled', false);
                                 }
                                 //$('#processAddToCart').attr('disabled', false);
                                 $('#processAddToCart').addClass('CMI-DA-Packages');
                                 
                                  $("#quoteLink").css("display", "block");
                                    $(".quoteLinkError").css("display", "none");
                             }
                            if(result.data.hasActiveSubs){
                                $("#quoteLink").addClass("rfq-disappear");
                                $(".quoteLinkError").addClass("rfq-disappear");
                                $('input[name="hasTnC"]').val(false);
                            }
                            
                            if(model.isTnC){
                                $('#processAddToCart').attr('disabled', true);
                                 $('#processAddToCart').removeClass('CMI-DA-Packages');
                                 $('input[name="hasTnC"]').val(true);
                            }
                            
                            
                            if(model.GOMSUser)
                            {
                                $('#processAddToCart').attr('disabled', true);
                                $('#GOMSMsg').show();
                                $('#GOMSPriceMsg').show();
                               
                            }
                            if(model.GOMSPriceMsg)
                            {
                             $('#GOMSPriceMsg').show();
                            }
                         }
                         else
                         {
                            console.log('************Error while fetching price of product*****');
                         }
                          
                        
                        
                          
                          },{buffer:false,escape:false,nmsp:false} );
                    },
                    processAddItem: function(event) {
                    var objLink = $(event.target);
                    var model = this.dataSet;
                    var sku=$('input[name="productSkuSelected"]').val();
                    var qty=$('input[name="subcQty"]').val();
                    var parentId=CCRZ.detailData.jsonProductData.uid;
                    var subslength = $('input[name="subslength"]').val();
                    var billingFreq = $('input[name="billingFreq"]:checked').val();
                    var compositKeyForSubProdTerm = JSON.parse($('input[name="compositKeyForSubProdTerm"]').val());
                    var prodMonthlyPrice = JSON.parse($('input[name="prodMonthlyPrice"]').val());
                    
                    
                    var compositekey = sku+billingFreq+subslength;
                    var subProdTermId = compositKeyForSubProdTerm[compositekey];
                    var selectedMonthlyPrice = prodMonthlyPrice[compositekey];
                    var prodTotalPrice = $('input[name="totalPrice"]').val();
                    
                    var showMessage;
                    var subTerm=subProdTermId;
                    var hasActiveSubs = $('input[name="hasActiveSubs"]').val();
                    if(!hasActiveSubs){
                    var sellerID;
                         if (!qty)
                         qty = 1;
                         
                         this.className = 'cc_RemoteActionController';
                         this.invokeContainerLoadingCtx(
                          $('.prodDetailContainer')
                          ,'addItem'
                          ,sku
                          ,qty
                          ,_.isUndefined(parentId)?null:parentId
                          ,_.isUndefined(subTerm)?null:subTerm
                          ,_.isUndefined(sellerID)?null:sellerID
                          ,null
                          ,function(response){
                           var cartId = response.data;
                           CCRZ.pagevars.currentCartID = cartId;
                           //cart change will update cookie
                           CCRZ.pubSub.trigger('cartChange', cartId);
                           if (showMessage) {
                            var msgArr = new Array();
                            msgArr[0] = sku;
                            var msg = CCRZ.processPageLabelMap('ADDED_TO_CART', msgArr);
                            var msgContext = CCRZ.createPageMessage('INFO', "messagingAction-Info", msg);
                            CCRZ.pubSub.trigger("pageMessage", msgContext);
                           }
                           this.className = 'cc_ctrl_ProductDetailRD';
                          
                          }
                         );
                         }else{
                            console.log('Has subscription calling external pricing');
                            
                            var remoteCall = _.extend(CCRZ.RemoteInvocation,{className:'OSM_SW_ProdDetail_DA_Comp_Ctrl'});
                                console.log(remoteCall);
                                        var myObject = new Object();
                                    myObject.subcQty = $('input[name="subcQty"]').val() != undefined ? $('input[name="subcQty"]').val() : '0';
                                    myObject.billingFreq = billingFreq;
                                    myObject.prodSubscriptions = $('input[name="subslength"]').val() != undefined ? $('input[name="subslength"]').val() : '';
                                    myObject.plan = $('input[name="buttonName"]').val() != undefined ? $('input[name="buttonName"]').val():'';
                                    myObject.rfqDescription = $('textarea#rfqQ_description').val() != undefined ? $('textarea#rfqQ_description').val() : '';
                                    myObject.userId = '{!$User.Id}';
                                    myObject.selectedProdSku = sku;
                                    myObject.totalPrice = $('input[name="totalPrice"]').val();
                                    myObject.monthlyPrice = selectedMonthlyPrice;
                                    myObject.selectedProratedPrice = model.selectedProratedPrice;                       
                                    myObject.store=CCRZ.pagevars.storefrontName;
                                    myObject.parentProdSku = CCRZ.detailData.jsonProductData.product.prodBean.SKU;
                                    myObject.subProdTermId = subProdTermId;
                                    myObject.parentId = CCRZ.detailData.jsonProductData.uid;
                                    console.log(myObject); 
                                    var myString = JSON.stringify(myObject);
                                        remoteCall.invokeContainerLoadingCtx($('.prodDetailContainer'),'addToCartExternal', myString, function(resp){
                                        console.log(resp);
                                        
                                        if (resp && resp.success){                   
                                                console.log('SUCCESS');
                                                console.log(resp);
                                                $(".onSuccessAddToCart").css("display", "block");
                                                if(resp.data && resp.data.cart_id){
                                                    CCRZ.pagevars.currentCartID = resp.data.cart_id;
                                                    console.log('Set the cartid ==='+CCRZ.pagevars.currentCartID);
                                                }
                                               CCRZ.pubSub.on('view:headerView:refresh',function(){
                                                    console.log('The header is being refreshed');
                                                });
                                                
                                               CCRZ.pubSub.trigger('cartChange', CCRZ.pagevars.currentCartID);
                                            }
                               },{ buffer : false, escape : false , nmsp:false });
                               
                                var parentsku = CCRZ.detailData.jsonProductData.product.prodBean.SKU                                
                                this.invokeContainerLoadingCtx($('body'),"WarningMsg",parentsku,
                                function(result,event) {
                                    console.log(result);
                                    if(result.success ) {
                                    console.log('result %o',result);
                                      
                                       if(result.data.PymntwrngMsg!=undefined && result.data.PymntwrngMsg ==true)
                                    {                                            
                                         $('#ShowWarningMsgID').modal('show');
                                    }
                                   
                                   }                            
                                },{buffer:false,escape:false,nmsp:false});
                         }
                         
                        },
                        processSelectProd:function(event){
                        var objLink = $(event.target);
                        console.log(objLink);
                        var yearlyPrice = objLink.data("price");
                        var buttonName = objLink.data("button");
                        $('input[name="buttonName"]').val(buttonName);
                        $("input[type=radio]").attr('disabled', false);
                         $("input[name='subcQty']").attr('disabled', false);
                         if(model.GOMSUser)
                         {
                            $('#processAddToCart').attr('disabled', true);
                            console.log('Step1>>>');
                         }
                         else
                         {
                            $('#processAddToCart').attr('disabled', false);
                         }
                         //$('#processAddToCart').attr('disabled', false);
                        
                        if(buttonName == 'Base'){
                            //$('.baseColor').css({'border': '1px solid #999999'})
                            //$('.baseColor').addClass('CMI-outer-border');
                            $('.CMI-baseColor').addClass('baseColor');
                            $('.CMI-plusColor').removeClass('plusColor');
                            $('.CMI-proColor').removeClass('proColor');
                            
                            $('.CMI-baseColor span').attr('class', 'CMI-Subscription-Icons');
                            $('.CMI-plusColor span').attr('class', 'CMI-Icons');
                            $('.CMI-proColor span').attr('class', 'CMI-Icons');
                           
                           $('#Pro').removeClass('CMI-DA-Packages');
                            $('#Plus').removeClass('CMI-DA-Packages');
                            $('#Base').addClass('CMI-DA-Packages');
                            
                            $( "#Base" ).parent( ".CMI-DA-table-cell-Base" ).addClass( 'CMI-DA-Packages');
                            $( "#Plus" ).parent( ".CMI-DA-table-cell-Plus" ).removeClass( 'CMI-DA-Packages');
                            $( "#Pro" ).parent( ".CMI-DA-table-cell-Pro" ).removeClass( 'CMI-DA-Packages');
                        }
                        if(buttonName == 'Plus'){
                            $('.CMI-baseColor').removeClass('baseColor');
                            $('.CMI-plusColor').addClass('plusColor');
                            $('.CMI-proColor').removeClass('proColor');
                            
                            $('.CMI-baseColor span').attr('class', 'CMI-Icons');
                            $('.CMI-plusColor span').attr('class', 'CMI-Subscription-Icons');
                            $('.CMI-proColor span').attr('class', 'CMI-Icons');
                           
                           $('#Pro').removeClass('CMI-DA-Packages');
                            $('#Plus').addClass('CMI-DA-Packages');
                            $('#Base').removeClass('CMI-DA-Packages');
                            $( "#Base" ).parent( ".CMI-DA-table-cell-Base" ).removeClass( 'CMI-DA-Packages');
                            $( "#Plus" ).parent( ".CMI-DA-table-cell-Plus" ).addClass( 'CMI-DA-Packages');
                            $( "#Pro" ).parent( ".CMI-DA-table-cell-Pro" ).removeClass( 'CMI-DA-Packages');
                        }
                        if(buttonName == 'Pro'){
                           $('.CMI-baseColor').removeClass('baseColor');
                            $('.CMI-plusColor').removeClass('plusColor');
                            $('.CMI-proColor').addClass('proColor');
                            $('.CMI-baseColor span').attr('class', 'CMI-Icons');
                            $('.CMI-plusColor span').attr('class', 'CMI-Icons');
                            $('.CMI-proColor span').attr('class', 'CMI-Subscription-Icons');
                            $('#Pro').addClass('CMI-DA-Packages');
                            $('#Plus').removeClass('CMI-DA-Packages');
                            $('#Base').removeClass('CMI-DA-Packages');
                            $( "#Base" ).parent( ".CMI-DA-table-cell-Base" ).removeClass( 'CMI-DA-Packages');
                            $( "#Plus" ).parent( ".CMI-DA-table-cell-Plus" ).removeClass( 'CMI-DA-Packages');
                            $( "#Pro" ).parent( ".CMI-DA-table-cell-Pro" ).addClass( 'CMI-DA-Packages');
                        }
                        var prodSku = objLink.data("sku");
                        $('input[name="productSkuSelected"]').val(prodSku);
                        this.calculatePrice('productSel',yearlyPrice);
                        },
                        processSelectNoOfSubsc:function(event){
                        var objLink = $(event.target);
                        
                        this.calculatePrice('noOfSubscriptions',objLink.val());
                        
                        },
                        processSelectSubsLength:function(event){
                        var objLink = $(event.target);
                        var model = this.dataSet;
                        var subslength = objLink.data("subslength");
                            $('input[name="subslength"]').val(subslength);
                            
                        console.log(objLink);
                        var subscriptionLength = objLink.data("multipler");
                       
                        this.calculatePrice('subsLength',subscriptionLength);
                        },
                        processSelectBillingFreq:function(event){
                            var objLink = $(event.target);
                            var model = this.dataSet;
                            console.log(objLink);
                            this.calculatePrice('billingFrequency',objLink.val());
                        },
                         calculatePrice: function(src,multipler){
                            
                            var model = this.dataSet;
                            console.log(model);
                            console.log(model.totalSubscriptionCount);
                            console.log(model.availableCount);
                            
                            var noOfSubscriptions;
                            if(src=='productSel')
                            {
                                model.productAnnualPrice = multipler;
                            }
                            else if(src=='subsLength')
                            {
                               model.subsLength = multipler;
                            }
                            else if(src=='noOfSubscriptions')
                            {
                                model.noOfSubscription = multipler; 
                                noOfSubscriptions = multipler;
                            }
                            else if(src=='billingFrequency')
                            {
                                model.noOfSubscription = parseInt($('input[name="subcQty"]').val()); 
                                noOfSubscriptions = parseInt($('input[name="subcQty"]').val());
                            }
                            
                            if(!model.noOfSubscription)
                            {
                               noOfSubscriptions = parseInt($('input[name="subcQty"]').val());
                            }
                            else
                            {
                               noOfSubscriptions = model.noOfSubscription;
                            }
                            var selectedSubsPrice = $('input[name="selectedSubsPrice"]').val();
                            var prodYearPrice = JSON.parse($('input[name="prodYearPrice"]').val());
                            var proratedPrice = JSON.parse($('input[name="proratedPrice"]').val());
                            var isSubscribed = JSON.parse($('input[name="isSubscribed"]').val());
                            var hasOtherProductSusbcription = JSON.parse($('input[name="hasOtherProductSusbcription"]').val());
                            var pricePerBillFrequency = JSON.parse($('input[name="pricePerBillFrequency"]').val());
                            var subslength = $('input[name="subslength"]').val();
                            var quantity = $('input[name="subcQty"]').val();
                            $(".subscriptionError").css("display", "none");
                            $(".rfqError").css("display", "none");
                            
                            $(".quoteLinkError").removeClass('disable-link');
                            if(quantity>model.availableCount  && "{!$Label.OSM_DA_API_VALIDATION}" == 'true'){
                                $(".subscriptionError").css("display", "block");
                                $('#processAddToCart').attr('disabled', true);
                                $("#quoteLink").css("display", "none");
                                $(".quoteLinkError").css("display", "block");
                                $(".quoteLinkError").addClass('disable-link');
                                return;
                            }
                            if(subslength == "{!$Label.OSM_Subscription_Length_1_Year}"){
                                $('input[id=Yearly]').prop('checked', false);
                                $('input[id=Yearly]').prop('disabled', true);
                            }else{
                                $('input[id=Yearly]').prop('disabled', false);
                            }
                            console.log(prodYearPrice);
                            var selectedSku = $('input[name="productSkuSelected"]').val();
                            console.log(selectedSku+subslength);
                            var subscriptionLengthLst = $('input[name="subscriptionLengthLst"]:checked').val();
                            var billingFreq = $('input[name="billingFreq"]:checked').val();
                             $(".CMI-Invoice-Message").css("display", "none");
                            if(!isSubscribed && billingFreq != undefined && billingFreq !='One Time'){
                                $(".CMI-Invoice-Message").css("display", "block");
                            }
                            
                            console.log(selectedSku+billingFreq+subslength);
                            var selectedSubsPrice = prodYearPrice[selectedSku+billingFreq+subslength];
                             var selectedProratedPrice = proratedPrice[selectedSku+billingFreq+subslength];
                             var selectedDnProratedPrice = model.proratedDnPrice[selectedSku+billingFreq+subslength];
                            var prodMonthlyPrice = JSON.parse($('input[name="prodMonthlyPrice"]').val());
                            var selectedMonthlyPrice = prodMonthlyPrice[selectedSku+billingFreq+subslength];
                            var selectedPerBillPrice = pricePerBillFrequency[selectedSku+billingFreq+subslength];
                            var pricePerbill = 0
                            var perFre = '';
                             var prorateddPricePerFrequency = '';
                            if(selectedPerBillPrice != undefined){
                             pricePerbill = (selectedPerBillPrice.split(" ")[0] != null && selectedPerBillPrice.split(" ")[0] != undefined) ? selectedPerBillPrice.split(" ")[0]:'';
                                perFre = (selectedPerBillPrice.split(" ")[1] != null && selectedPerBillPrice.split(" ")[1] != undefined) && (selectedPerBillPrice.split(" ")[2] != null && selectedPerBillPrice.split(" ")[2] != undefined) ? selectedPerBillPrice.split(" ")[1]+' '+selectedPerBillPrice.split(" ")[2]:'';
                                
                               if(isSubscribed || (!isSubscribed && hasOtherProductSusbcription && billingFreq!='One Time')){
                                    prorateddPricePerFrequency = selectedProratedPrice.toFixed(2)+' '+perFre; 
                                   }
                            }
                             
                               console.log(perFre);
                            $(".rfqSuccess").css("display", "none");
                            $(".freeTrialSuccess").css("display", "none");
                            if(quantity != undefined &&  quantity!=0 && quantity !='' && subscriptionLengthLst != undefined && billingFreq != undefined){
                                if(!isSubscribed){
                                $( "div.costSubscription").replaceWith( '<div class="form-group costSubscription"><label class="col-xs-5 col-md-4 control-label" for="radios"><B>Cost Per Subscription</B></label><div class="col-xs-6 col-md-8"><div class="costCalPerYear costPerYear"> $'+ selectedPerBillPrice+'</div> </div></div>');
                                }
                                
                                if(isSubscribed || (!isSubscribed && hasOtherProductSusbcription && billingFreq!='One Time')){
                                        $( "div.costSubscription").replaceWith( '<div class="form-group costSubscription"><label class="col-xs-5 col-md-4 control-label" for="radios"><B>Cost Per Subscription</B></label><div class="col-xs-6 col-md-8"><div class="costCalPerYear costPerYear"> $'+ prorateddPricePerFrequency+'</div> </div></div>');
                                    }
                                    if(model.GOMSUser)
                                     {
                                        $('#processAddToCart').attr('disabled', true);
                                        console.log('Step2>>>');
                                     }
                                     else
                                     {
                                        $('#processAddToCart').attr('disabled', false);
                                     }
                                 //$('#processAddToCart').attr('disabled', false);
                                $("#quoteLink").css("display", "block");
                                $(".quoteLinkError").css("display", "none");
                                $(".rfqError").css("display", "none");
                                 $('#processAddToCart').addClass('CMI-DA-Packages');
                                 
                                 
                                 var currentdate = new Date();
                                var datetime = currentdate.getDay() + "/"+currentdate.getMonth() 
                                + "/" + currentdate.getFullYear() + " " 
                                + currentdate.getHours() + ":" 
                                + currentdate.getMinutes() + ":" + currentdate.getSeconds();
                                var currdate = new Date().toLocaleString();
                                 $( "label.RequestedDate" ).replaceWith('<label class="form-control RequestedDate" id="RequestedDate" >'+currdate+'</label>');
                                 $( "div.Product" ).replaceWith('<div class="col-md-1-x Product" style="width:19%"><B>'+CCRZ.detailData.jsonProductData.product.prodBean.name+'</B></div>');
                                 $( "div.Plan" ).replaceWith('<div class="col-md-1-x Plan" style="width:19%"><B>'+$('input[name="buttonName"]').val()+'</B></div>');
                                 $( "div.Equipment" ).replaceWith('<div class="col-md-1-x Equipment" style="width:19%"><B>'+$('input[name="availableCount"]').val()+'</B></div>');
                                 $( "div.UnitPrice" ).replaceWith('<div class="col-md-1-x UnitPrice" style="width:19%"><B> $'+selectedMonthlyPrice.toFixed(2)+'</B></div>');
                                $( "div.rfq-quantity" ).replaceWith('<div class="col-md-1-x rfq-quantity" style="width:19%"><B>'+quantity+'</B></div>');
                                $( "div.rfq-subscription" ).replaceWith('<div class="col-md-1-x rfq-subscription" style="width:19%"><B>'+subslength+'</B></div>');
                      var totalPrice = 0;
                                 model.selectedProratedPrice = noOfSubscriptions*selectedDnProratedPrice.toFixed(2);
                                                   
                                 console.log(isSubscribed+'--&&--'+selectedProratedPrice+'==='+isSubscribed && selectedProratedPrice > 0);
                               if(isSubscribed || (!isSubscribed && hasOtherProductSusbcription && billingFreq!="One Time")){
                                    totalPrice = noOfSubscriptions*selectedProratedPrice.toFixed(2);
                                    console.log('If--'+totalPrice);
                                    }else{
                                         totalPrice = noOfSubscriptions*selectedSubsPrice.toFixed(2);
                                        console.log('else--'+totalPrice);
                                        }
                                if(!isSubscribed && selectedProratedPrice > 0 && billingFreq != 'One Time'){
                                    }
                                if(!isNaN(totalPrice))
                                {
                                    var totalPriceFre = (totalPrice.toFixed(2)+' '+perFre);
                                    console.log(totalPriceFre);
                                    $( "div.totalCostPerYear" ).replaceWith('<div class="form-group totalCostPerYear"><label class="col-xs-5 col-md-4 control-label" for="radios"><B>Total Cost</B></label><div class="col-xs-6 col-md-8"> <div class="totalcostCal costPerYear "><B>$'+totalPriceFre +'</B></div><div></div>');
                                    $('input[name="totalPrice"]').val(totalPrice);
                                }
                                else
                                {
                                    $('#processAddToCart').attr('disabled', true);
                                      $( "div.totalCostPerYear" ).replaceWith('<div class="totalCostPerYear"></div>');
                                       $( "div.costSubscription" ).replaceWith('<div class="costSubscription"></div>');
                                       $("#quoteLink").css("display", "none");
                                    $(".quoteLinkError").css("display", "block");
                                    $(".quoteLinkError").addClass('disable-link');
                                    console.log('==totalPrice is NAN');
                                }
                                
                                var hasTnC = false;
                            if($('input[id="termAndCondition"]').val() != undefined && JSON.parse($('input[id="termAndCondition"]').val())){
                                hasTnC = true;
                            }
                            if(hasTnC){
                                if($('input[id="termAndCondition"]:checked').val()== undefined){
                                    $('#processAddToCart').attr('disabled', true);
                                    $('#processAddToCart').removeClass('CMI-DA-Packages');
                                }else{
                                        if(model.GOMSUser)
                                         {
                                            $('#processAddToCart').attr('disabled', true);
                                            console.log('Step3>>>');
                                         }
                                         else
                                         {
                                            $('#processAddToCart').attr('disabled', false);
                                            $('#processAddToCart').addClass('CMI-DA-Packages');
                                         }
                                        //$('#processAddToCart').attr('disabled', false);
                                        //$('#processAddToCart').addClass('CMI-DA-Packages');
                                    }
                            }
                                
                            }else{
                                    $('#processAddToCart').attr('disabled', true);
                                $('#processAddToCart').removeClass('CMI-DA-Packages');
                                $("#quoteLink").css("display", "none");
                                $(".quoteLinkError").css("display", "block");
                                
                                //$(".subscriptionError").css("display", "block");
                                if(quantity==''){
                                    $(".subscriptionError").css("display", "none");
                                }
                                $('#processAddToCart').attr('disabled', true);
                                
                            }
                         },
                         
                         openRFQModal:function(event){
                             $('.messagingSection-rfq-Error').css('display', 'none');
                             console.log('Modal Clicked');
                             console.log("$User.FirstName");
                         },
                         
                          rfqSubmit : function(event) {
                              console.log('got cart change!');
                              console.log(CCRZ.pagevars.storefrontName);
                              $('#submitRFQ').attr('disabled', true);
                               $('.submitProcessing').css('display', 'block');
                              
                             var selectedProdSku = $('input[name="productSkuSelected"]').val();
                             var billingFreq = $('input[name="billingFreq"]:checked').val();
                             var prodSubscriptions = $('input[name="prodSubscriptions"]:checked').val();
                             var subslength = $('input[name="subslength"]').val();
                             var reccurringPriceMap = JSON.parse($('input[name="subProdTermPrices"]').val()); 
                             var compositKeyForSubProdTerm = JSON.parse($('input[name="compositKeyForSubProdTerm"]').val());
                             var compositekey = selectedProdSku+billingFreq+subslength;
                            var subProdTermId = compositKeyForSubProdTerm[compositekey];
                            var prodYearPrice = JSON.parse($('input[name="prodYearPrice"]').val());
                            var selectedSubsPrice = prodYearPrice[compositekey];
                            var prodMonthlyPrice = JSON.parse($('input[name="prodMonthlyPrice"]').val());
                            var selectedMonthlyPrice = prodMonthlyPrice[compositekey];
                            var availableCount = $('input[name="availableCount"]').val();
                              //productSku 
                              
                              var remoteCall = _.extend(CCRZ.RemoteInvocation,{className:'OSM_SW_ProdDetail_DA_Comp_Ctrl'});
                                console.log(remoteCall);
                                        var myObject = new Object();
                                    myObject.subcQty = $('input[name="subcQty"]').val() != undefined ? $('input[name="subcQty"]').val() : '0';
                                    myObject.billingFreq = $('input[name="billingFreq"]').val() != undefined ? $('input[name="billingFreq"]').val() : '';
                                    myObject.prodSubscriptions = $('input[name="subslength"]').val() != undefined ? $('input[name="subslength"]').val() : '';
                                    myObject.plan = $('input[name="buttonName"]').val() != undefined ? $('input[name="buttonName"]').val():'';
                                    myObject.rfqDescription = $('textarea#rfqQ_description').val() != undefined ? $('textarea#rfqQ_description').val() : '';
                                    myObject.userId = '{!$User.Id}';
                                    myObject.selectedProdSku = selectedProdSku;
                                    myObject.unitPrice = selectedSubsPrice;
                                    myObject.totalPrice = $('input[name="totalPrice"]').val();
                                    myObject.monthlyPrice = selectedMonthlyPrice;
                                    myObject.availableCount = availableCount;
                                    myObject.store=CCRZ.pagevars.storefrontName;
                                    //myObject.cartId = cartId;
                                    myObject.subProdTermId = subProdTermId;
                                    myObject.parentId = CCRZ.detailData.jsonProductData.uid;
                                    console.log('++++++++++++++++++++++++');
                                    console.log(myObject); 
                                    var myString = JSON.stringify(myObject); 
                              /*this.invokeContainerLoadingCtx($('body'),"submitQuote",myString,
                                        function(resp,event){*/
                                OSM_SW_ProdDetail_DA_Comp_Ctrl.submitQuote(CCRZ.pagevars.remoteContext,myString, function(resp){
                                        event.preventDefault();
                                        console.log('doSubscription');
                                        console.log('resp data => ' + resp);
                                        console.log(resp);
                                        if (resp.success){                   
                                                console.log('SUCCESS');
                                                console.log(resp);
                                                $('#quoteModal').modal('hide');
                                                $(".rfqSuccess").css("display", "block");
                                                $("#quoteLink").addClass("rfq-disappear");
                                                $(".quoteLinkError").addClass("rfq-disappear");
                                                if(resp.data != undefined && resp.data){
                                                    $('.rfqSuccess').text(resp.data);
                                                    $(".rfqSuccess").css("display", "block");
                                                }
                                        }else{
                                                console.log('quote approval failed');
                                                $('.messagingSection-rfq-Error').css('display', 'block');
                                        }
                                     $('#submitRFQ').attr('disabled', false);
                                     $('.submitProcessing').css('display', 'none');
                               });
                               return false;
                                       
                            },
                            
                            quoteLinkError : function(event){
                             $(".rfqError").css("display", "block");
                             console.log('Modal Clicked');
                             console.log("$User.FirstName");
                             $(".quoteLinkError").addClass('disable-link');
                             $(".rfqSuccess").addClass('disable-link');
                         }
                         
                    });

                    CCRZ.subsPackageView = new CCRZ.views.SubscriptionPackageView({
                    model:new CCRZ.models.SubscriptionPackageModel
                    });   
        //Handlebars.registerPartial("mainDASection", $('#CMI_ProductDetail-SubscPackage-Desktop').html());
   }); // End of JQuery Function
    </script>

  {!blank}
</apex:component>